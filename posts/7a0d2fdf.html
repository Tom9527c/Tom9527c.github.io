<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>TypeScript笔记(二) | Tom</title><meta name="keywords" content="前端,TypeScript,笔记,练习"><meta name="author" content="Tom"><meta name="copyright" content="Tom"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="TypeScript笔记(二)"><meta name="application-name" content="TypeScript笔记(二)"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="ffffff"><meta property="og:type" content="article"><meta property="og:title" content="TypeScript笔记(二)"><meta property="og:url" content="https://tom9527c.github.io/posts/7a0d2fdf.html"><meta property="og:site_name" content="Tom"><meta property="og:description" content="TypeScript的学习笔记和总结"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://mypic-ezp.pages.dev/img/img34.jpg"><meta property="article:author" content="Tom"><meta property="article:tag" content="代码,博客"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://mypic-ezp.pages.dev/img/img34.jpg"><meta name="description" content="TypeScript的学习笔记和总结"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://tom9527c.github.io/posts/7a0d2fdf"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="var(--anzhiyu-main)"/><link rel="mask-icon" href="/img/siteicon/coffee.png" color="#5bbad5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/coffee.png"/><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/coffee.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/coffee.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/coffee.png"/><link rel="bookmark" href="/img/siteicon/coffee.png"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"👀跑哪里去了~","backTitle":"🐖抓到你啦～"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: {"appId":"IZ92U5VWUK","apiKey":"74b5762fa3c8aaafea1158754e1ca277","indexName":"aurora","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"距离上次更新已经","messageNext":"天了，文章内容可能已经过时。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Tom","link":"链接: ","source":"来源: Tom","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Tom',
  title: 'TypeScript笔记(二)',
  postAI: '',
  pageFillDescription: '1. 泛型 (generic), 文档解释, 介绍, 泛型之Hello World, 使用泛型变量, 泛型类型, 泛型类, 泛型约束, 在泛型约束中使用类型参数, 在泛型里使用类类型, 学习解释, 指定函数参数类型, 函数标注的方式, 泛型接口使用, 默认泛型, 类中的泛型, 泛型约束 (extends), 2.类型兼容性, 文档解释, 介绍, 关于可靠性的注意事项, 开始, 比较两个函数, 函数参数双向协变, 可选参数及剩余参数, 函数重载, 枚举, 类, 类的私有成员, 泛型, 高级主题, 子类型与赋值, 学习解释, 基本数据类型的兼容性, 接口兼容性, 函数的兼容性,  , 类的兼容性, 泛型的兼容性, 枚举的兼容性, 对象的兼容性, 类型层级兼容性, 函数的逆变与协变, 逆变带来的问题, 3.类型保护, typeof类型保护, instanceof类型保护, in类型保护, 可辨识联合类型, null保护, 自定义类型保护, 完整性保护, 4.交叉类型, 交叉类型 (Intersection Types), 快速扩展属性, 5.条件类型, 条件类型基本使用, 条件类型分发, any自带分发的机制, 联合类型的子类型 是联合类型中的某个类型, T amp 123125 就可以解决分发问题, 6.内置类型, Exclude排除类型, Extract抽取类型, NoNullable 非空检测, ReturnType返回值的类型, Parameters 返回参数的类型, ConstructorParameters返回构造函数的参数类型, InstanceType 返回实例的类型, infer实践, Partial转化可选属性, Required转化必填属性, Readonly转化仅读属性, Pick挑选所需的属性, Omit忽略属性, Record记录类型, 7.循环类型泛型文档解释介绍软件工程中我们不仅要创建一致的定义良好的同时也要考虑可重用性组件不仅能够支持当前的数据类型同时也能支持未来的数据类型这在创建大型系统时为你提供了十分灵活的功能在像和这样的语言中可以使用泛型来创建可重用的组件一个组件可以支持多种类型的数据这样用户就可以以自己的数据类型来使用组件泛型之下面来创建第一个使用泛型的例子函数这个函数会返回任何传入它的值你可以把这个函数当成是命令不用泛型的话这个函数可能是下面这样或者我们使用类型来定义函数使用类型会导致这个函数可以接收任何类型的参数这样就丢失了一些信息传入的类型与返回的类型应该是相同的如果我们传入一个数字我们只知道任何类型的值都有可能被返回因此我们需要一种方法使返回值的类型与传入参数的类型是相同的这里我们使用了类型变量它是一种特殊的变量只用于表示类型而不是值我们给添加了类型变量帮助我们捕获用户传入的类型比如之后我们就可以使用这个类型之后我们再次使用了当做返回值类型现在我们可以知道参数类型与返回值类型是相同的了这允许我们跟踪函数里使用的类型的信息我们把这个版本的函数叫做泛型因为它可以适用于多个类型不同于使用它不会丢失信息像第一个例子那像保持准确性传入数值类型并返回数值类型我们定义了泛型函数后可以用两种方法使用第一种是传入所有的参数包含类型参数这里我们明确的指定了是类型并做为一个参数传给函数使用了括起来而不是第二种方法更普遍利用了类型推论即编译器会根据传入的参数自动地帮助我们确定的类型注意我们没必要使用尖括号来明确地传入类型编译器可以查看的值然后把设置为它的类型类型推论帮助我们保持代码精简和高可读性如果编译器不能够自动地推断出类型的话只能像上面那样明确的传入的类型在一些复杂的情况下这是可能出现的使用泛型变量使用泛型创建像这样的泛型函数时编译器要求你在函数体必须正确的使用这个通用的类型换句话说你必须把这些参数当做是任意或所有类型看下之前例子如果我们想同时打印出的长度我们很可能会这样做如果这么做编译器会报错说我们使用了的属性但是没有地方指明具有这个属性记住这些类型变量代表的是任意类型所以使用这个函数的人可能传入的是个数字而数字是没有属性的现在假设我们想操作类型的数组而不直接是由于我们操作的是数组所以属性是应该存在的我们可以像创建其它数组一样创建这个数组你可以这样理解的类型泛型函数接收类型参数和参数它是个元素类型是的数组并返回元素类型是的数组如果我们传入数字数组将返回一个数字数组因为此时的的类型为这可以让我们把泛型变量当做类型的一部分使用而不是整个类型增加了灵活性我们也可以这样实现上面的例子使用过其它语言的话你可能对这种语法已经很熟悉了在下一节会介绍如何创建自定义泛型像一样泛型类型上一节我们创建了通用函数可以适用于不同的类型在这节我们研究一下函数本身的类型以及如何创建泛型接口泛型函数的类型与非泛型函数的类型没什么不同只是有一个类型参数在最前面像函数声明一样我们也可以使用不同的泛型参数名只要在数量上和使用方式上能对应上就可以我们还可以使用带有调用签名的对象字面量来定义泛型函数这引导我们去写第一个泛型接口了我们把上面例子里的对象字面量拿出来做为一个接口一个相似的例子我们可能想把泛型参数当作整个接口的一个参数这样我们就能清楚的知道使用的具体是哪个泛型类型比如而不只是这样接口里的其它成员也能知道这个参数的类型了注意我们的示例做了少许改动不再描述泛型函数而是把非泛型函数签名作为泛型类型一部分当我们使用的时候还得传入一个类型参数来指定泛型类型这里是锁定了之后代码里使用的类型对于描述哪部分类型属于泛型部分来说理解何时把参数放在调用签名里和何时放在接口上是很有帮助的除了泛型接口我们还可以创建泛型类注意无法创建泛型枚举和泛型命名空间泛型类泛型类看上去与泛型接口差不多泛型类使用括起泛型类型跟在类名后面类的使用是十分直观的并且你可能已经注意到了没有什么去限制它只能使用类型也可以使用字符串或其它更复杂的类型与接口一样直接把泛型类型放在类后面可以帮助我们确认类的所有属性都在使用相同的类型我们在类那节说过类有两部分静态部分和实例部分泛型类指的是实例部分的类型所以类的静态属性不能使用这个泛型类型泛型约束你应该会记得之前的一个例子我们有时候想操作某类型的一组值并且我们知道这组值具有什么样的属性在例子中我们想访问的属性但是编译器并不能证明每种类型都有属性所以就报错了相比于操作所有类型我们想要限制函数去处理任意带有属性的所有类型只要传入的类型有这个属性我们就允许就是说至少包含这一属性为此我们需要列出对于的约束要求为此我们定义一个接口来描述约束条件创建一个包含属性的接口使用这个接口和关键字还实现约束现在这个泛型函数被定义了约束因此它不再是适用于任意类型我们需要传入符合约束类型的值必须包含必须的属性在泛型约束中使用类型参数你可以声明一个类型参数且它被另一个类型参数所约束比如现在我们想要用属性名从对象里获取这个属性并且我们想要确保这个属性存在于对象上因此我们需要在这两个类型之间使用约束在泛型里使用类类型在使用泛型创建工厂函数时需要引用构造函数的类类型比如一个更高级的例子使用原型属性推断并约束构造函数与类实例的关系学习解释指定函数参数类型泛型可以用于函数接口类如果在使用的时候无法确定当时的类型可以采用泛形来定义单个泛型多个泛型写辅助函数的函数的时候可以写多个泛型用于保存值值的交换表示使用接口的时候确定类型在使用这个函数的函数传入类型错误写法泛型的使用需要能正常推到但是内部的没有真正的执行还是认为并没有真正的执行内部的使用才传递的类型而不是定义接口的时候传递类型函数标注的方式类型别名可以使用类型别名但是类型别名不能被继承和实现一般联合类型可以使用类型别名来声明接口能使用尽量使用泛型接口使用接口的返回值可能都是统一的泛型的默认值来解决泛型的值默认情况这里的是使用接口的时候传入这里的是调用函数的时候传入请求方法张三成功在平时开发中我门想使用联合类型默认泛型可以指定泛型的默认类型方便使用类中的泛型创建实例时提供类型校验构造函数类型只是对类型做校验对于真正的业务逻辑不关心泛型约束泛型必须包含某些属性泛型是用户传递的类型用户随便传在使用泛型的时候都要添加约束泛型约束我门在使用泛型的时候不能直接做运算的无法保证泛型的结果约束当前这个类型需要是子类型约束是某种类型的子类型返回泛型中指定属性类型兼容性文档解释介绍里的类型兼容性是基于结构子类型的结构类型是一种只使用其成员来描述类型的方式它正好与名义类型形成对比译者注在基于名义类型的类型系统中数据类型的兼容性或等价性是通过明确的声明和或类型的名称来决定的这与结构性类型系统不同它是基于类型的组成结构且不要求明确地声明看下面的例子在使用基于名义类型的语言比如或中这段代码会报错因为类没有明确说明其实现了接口的结构性子类型是根据代码的典型写法来设计的因为里广泛地使用匿名对象例如函数表达式和对象字面量所以使用结构类型系统来描述这些类型比使用名义类型系统更好关于可靠性的注意事项的类型系统允许某些在编译阶段无法确认其安全性的操作当一个类型系统具此属性时被当做是不可靠的允许这种不可靠行为的发生是经过仔细考虑的通过这篇文章我们会解释什么时候会发生这种情况和其有利的一面开始结构化类型系统的基本规则是如果要兼容那么至少具有与相同的属性比如这里要检查是否能赋值给编译器检查中的每个属性看是否能在中也找到对应属性在这个例子中必须包含名字是的类型成员满足条件因此赋值正确检查函数参数时使用相同的规则注意有个额外的属性但这不会引发错误只有目标类型这里是的成员会被一一检查是否兼容这个比较过程是递归进行的检查每个成员及子成员比较两个函数相对来讲在比较原始类型和对象类型的时候是比较容易理解的问题是如何判断两个函数是兼容的下面我们从两个简单的函数入手它们仅是参数列表略有不同要查看是否能赋值给首先看它们的参数列表的每个参数必须能在里找到对应类型的参数注意的是参数的名字相同与否无所谓只看它们的类型这里的每个参数在中都能找到对应的参数所以允许赋值第二个赋值错误因为有个必需的第二个参数但是并没有所以不允许赋值你可能会疑惑为什么允许忽略参数像例子中那样原因是忽略额外的参数在里是很常见的例如给回调函数传个参数数组元素索引和整个数组尽管如此传入一个只使用第一个参数的回调函数也是很有用的下面来看看如何处理返回值类型创建两个仅是返回值类型不同的函数类型系统强制源函数的返回值类型必须是目标函数返回值类型的子类型函数参数双向协变当比较函数参数类型时只有当源函数参数能够赋值给目标函数或者反过来时才能赋值成功这是不稳定的因为调用者可能传入了一个具有更精确类型信息的函数但是调用这个传入的函数的时候却使用了不是那么精确的类型信息实际上这极少会发生错误并且能够实现很多里的常见模式例如可选参数及剩余参数比较函数兼容性的时候可选参数与必须参数是可互换的源类型上有额外的可选参数不是错误目标类型的可选参数在源类型里没有对应的参数也不是错误当一个函数有剩余参数时它被当做无限个可选参数这对于类型系统来说是不稳定的但从运行时的角度来看可选参数一般来说是不强制的因为对于大多数函数来说相当于传递了一些有一个好的例子常见的函数接收一个回调函数并用对于程序员来说是可预知的参数但对类型系统来说是不确定的参数来调用函数重载对于有重载的函数源函数的每个重载都要在目标函数上找到对应的函数签名这确保了目标函数可以在所有源函数可调用的地方调用枚举枚举类型与数字类型兼容并且数字类型与枚举类型兼容不同枚举类型之间是不兼容的比如类类与对象字面量和接口差不多但有一点不同类有静态部分和实例部分的类型比较两个类类型的对象时只有实例的成员会被比较静态成员和构造函数不在比较的范围内类的私有成员私有成员会影响兼容性判断当类的实例用来检查兼容时如果目标类型包含一个私有成员那么源类型必须包含来自同一个类的这个私有成员这允许子类赋值给父类但是不能赋值给其它有同样类型的类泛型因为是结构性的类型系统类型参数只影响使用其做为类型一部分的结果类型比如上面代码里和是兼容的因为它们的结构使用类型参数时并没有什么不同把这个例子改变一下增加一个成员就能看出是如何工作的了在这里泛型类型在使用时就好比不是一个泛型类型对于没指定泛型类型的泛型参数时会把所有泛型参数当成比较然后用结果类型进行比较就像上面第一个例子比如高级主题子类型与赋值目前为止我们使用了兼容性它在语言规范里没有定义在里有两种类型的兼容性子类型与赋值它们的不同点在于赋值扩展了子类型兼容允许给赋值或从取值和允许数字赋值给枚举类型或枚举类型赋值给数字语言里的不同地方分别使用了它们之中的机制实际上类型兼容性是由赋值兼容性来控制的即使在和语句也不例外更多信息请参阅语言规范学习解释基本数据类型的兼容性兼容性分成两种子父结构来考虑类型层级结构来考虑安全性主要考虑的就是安全安全就可以进行复制你要的我有就可以字符串中具备方法所以可以进行兼容接口兼容性回龙观接口的兼容性只要满足接口中所需要的类型即可函数的兼容性函数的兼容性主要是比较参数和返回值参数赋值函数的参数要少于等于被赋值的函数与对象相反例如返回值参数和返回值的兼容性对于函数而言他的兼容性少的可以赋予给多的参数少的是子类型返回值要求安全返回值要求是子类型调用函数的时候会传递多个参数类的兼容性这里要注意的是只要有或者关键字类型就会不一致但是继承的类可以兼容类的兼容性也是一样比较的是实例如果类中的属性有或者则两个值不能互相复制这种叫结构化类型标称类型希望给基本类型做区分达到差异化的目的基于内置类型来做构建泛型的兼容性泛型兼容性如果生成的结果一致类型就就兼容生成结构一致即可枚举的兼容性错误语法两个枚举之间不能兼容不同的枚举类型不兼容对象的兼容性对象的兼容性多的属性可以赋予给少的类型层级兼容性字面量基础类型包装类型子父满足即可赋值函数的逆变与协变函数的参数是逆变的返回值是协变的在非严格模式下函数的参数是双向协变的回龙观吉姆通过这个案例可以说明函数参数可以接收父类返回值可以返回子类逆变在函数参数可以标记儿子传父亲和协变可以标记父亲返回儿子安全性考虑内部调用函数的时候可以传递和但是在使用属性时只能认为最多就是函数的返回值需要返回子类因为内部代码在访问属性的时候要保证可以访问到我交给回调的有房有车基于函数参数的逆变逆变带来的问题我们写业务的时候还是要正常开启逆变这种写法不进行逆变检测所有在描述对象中的方法时全部采用这种方式将赋予给传父返儿子能不能赋予给类型保护通过判断识别所执行的代码块自动识别变量属性和方法类型保护基于收窄很多情况下需要使用联合类型默认情况下只能使用公共的方法识别类型针对某个类型进行处理基础类型类类型接口类型可辨识类型类型保护类型保护类型保护语法语法主要在辅助的方法中用的比较多鸟鱼的返回值类型函数的名字和返回值是无关的是还是是基于差异化来辨别可辨识联合类型可辨识类型通过来实现鸟鱼基于差异化来辨别鸟通过各种判断来缩小范围生命周期函数的嵌套不识别的问题都有缩小范围的用途基于上下文类型的推导会因为作用域的变化而产生问题一定存在的意思取值断言就是自己说的算出错了自己承担无法识别的时候需要用断言保护这里要注意的是无法检测内部函数变量类型自定义类型保护完整性保护必须实现所有逻辑交叉类型交叉类型是将多个类型合并为一个类型联合类型并集按位或交叉类型交集按位与交叉类型帅高举例我们提供两拨人一拨人都很帅另一拨人很高我们希望找到他们的交叉部分又高又帅的人两个属性之间的值为如果两个类型不相同没有交集集后的结果是高交叉类型同时是两个类型的子类型最终的结果可以赋予给任何的一个类型帅高子类型可以赋予给父类型子类型的结构要包含父类型的结构快速扩展属性交叉类型和联合类型的区别平时我门使用的交叉类型场景还是很多的条件类型条件类型三元表达式左边和右边的关系条件类型基本使用可以使用关键字和三元表达式实现条件判断水子类型父类型类型级别根据结构的角度来分析从类型角度来进行分析是任何类型的子类型字面量类型基础类型包装的类型和可以看成字面量类型因为从结构角度出发可以看成结构和类型两部分条件类型是有分发机制除了的部分条件类型分发水这里会用每一项依次进行分发最终采用联合类型作为结果等价于自带分发的机制如果通过泛型传入此时只会返回联合类型的子类型是联合类型中的某个类型通过条件类型来进行类型的区分条件语句也可以实现约束的效果鱼鸟水天就可以解决分发问题分发导致的问题什么时候会有分发联合类型通过泛型传递而且比较的时候会产生分发类型需要是裸类型裸类型就是泛型就自己没有和别人搭配分发机制有的场景需要有的场景需要禁用不能一概而论判断两个类型是否完全一致映射关系可以考虑用泛型参数个数不一致类型和入参数无法考虑重载内置类型排除类型抽取类型非空检测返回值的类型返回参数的类型返回构造函数的参数类型返回实例的类型实践将数组类型转化为联合类型将两个函数的参数转化为交叉类型表示要把赋予给那么的值就是的交集参数是逆变的可以传父类的类型主要是为了代码的安全性来考虑所以所有的兼容性问题都要从安全性来考虑转化可选属性实现原理遍历所有的属性将属性设置为可选属性但是无法实现深度转化我们可以实现深度转化如果值是对象继续深度转化转化必填属性将所有的属性转化成必填属性转化仅读属性将所有属性变为仅读状态不能修改就是却掉挑选所需的属性在已有类型中挑选所需属性忽略属性回龙观忽略中的属性先排除掉不需要的在通过选出需要的属性对象来操作的和用的比较多记录类型实现方法我们经常用类型表示映射类型推导出类型根据泛型的位置来推导具体的类型手动类型推导类型推断因为需要关键字所以必须构建一个条件关键字需要基于如何讲一个元组转化成联合和类型对元组进行参数移动将元组头尾进行交换要配合可以递归推断循环类型除了基于条件类型之外我门还有基于对象类型使用场景比较多内置类型递归的深度可选递归的深度可选',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-05 18:06:49',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="/custom/css/elementUI.min.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="/custom/css/aurora.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Tom" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Tom</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)" rel="external nofollow noreferrer">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="anzhiyufont anzhiyu-icon-book-open faa-tada" style="font-size: 0.9em;"></i><span> 藏宝阁</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AJAX/" style="font-size: 1.05rem;">AJAX<sup>1</sup></a><a href="/tags/AXIOS/" style="font-size: 1.05rem;">AXIOS<sup>1</sup></a><a href="/tags/CSS/" style="font-size: 1.05rem;">CSS<sup>3</sup></a><a href="/tags/CSS3/" style="font-size: 1.05rem;">CSS3<sup>1</sup></a><a href="/tags/DOS-%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">DOS 命令<sup>1</sup></a><a href="/tags/ES6/" style="font-size: 1.05rem;">ES6<sup>4</sup></a><a href="/tags/HTML/" style="font-size: 1.05rem;">HTML<sup>3</sup></a><a href="/tags/HTML5/" style="font-size: 1.05rem;">HTML5<sup>1</sup></a><a href="/tags/JS/" style="font-size: 1.05rem;">JS<sup>1</sup></a><a href="/tags/Javascript/" style="font-size: 1.05rem;">Javascript<sup>1</sup></a><a href="/tags/Less/" style="font-size: 1.05rem;">Less<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/Markdown/" style="font-size: 1.05rem;">Markdown<sup>1</sup></a><a href="/tags/Mobile-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91/" style="font-size: 1.05rem;">Mobile(移动端开发)<sup>1</sup></a><a href="/tags/NPM/" style="font-size: 1.05rem;">NPM<sup>1</sup></a><a href="/tags/Sass/" style="font-size: 1.05rem;">Sass<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem;">TypeScript<sup>4</sup></a><a href="/tags/VUE/" style="font-size: 1.05rem;">VUE<sup>1</sup></a><a href="/tags/Vuex/" style="font-size: 1.05rem;">Vuex<sup>1</sup></a><a href="/tags/WebSocket/" style="font-size: 1.05rem;">WebSocket<sup>1</sup></a><a href="/tags/Webpack/" style="font-size: 1.05rem;">Webpack<sup>2</sup></a><a href="/tags/brew/" style="font-size: 1.05rem;">brew<sup>1</sup></a><a href="/tags/eggjs/" style="font-size: 1.05rem;">eggjs<sup>1</sup></a><a href="/tags/jquery/" style="font-size: 1.05rem;">jquery<sup>1</sup></a><a href="/tags/mysql/" style="font-size: 1.05rem;">mysql<sup>1</sup></a><a href="/tags/node/" style="font-size: 1.05rem;">node<sup>1</sup></a><a href="/tags/nvm/" style="font-size: 1.05rem;">nvm<sup>1</sup></a><a href="/tags/react/" style="font-size: 1.05rem;">react<sup>1</sup></a><a href="/tags/vue-i18n/" style="font-size: 1.05rem;">vue-i18n<sup>1</sup></a><a href="/tags/yarn/" style="font-size: 1.05rem;">yarn<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>25</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/" style="font-size: 1.05rem;">前端框架<sup>2</sup></a><a href="/tags/%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">包管理工具<sup>1</sup></a><a href="/tags/%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">命令<sup>1</sup></a><a href="/tags/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/" style="font-size: 1.05rem;">外挂标签<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91/" style="font-size: 1.05rem;">微信小程序开发<sup>1</sup></a><a href="/tags/%E7%9F%A5%E5%85%B6%E6%89%80%E4%BB%A5%E7%84%B6/" style="font-size: 1.05rem;">知其所以然<sup>3</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">笔记<sup>3</sup></a><a href="/tags/%E7%BB%83%E4%B9%A0/" style="font-size: 1.05rem;">练习<sup>6</sup></a><a href="/tags/%E9%9D%99%E6%80%81%E6%A8%A1%E5%9D%97%E6%89%93%E5%8C%85%E5%99%A8/" style="font-size: 1.05rem;">静态模块打包器<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">23</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);" rel="external nofollow noreferrer"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>前端</span></a><a class="article-meta__tags" href="/tags/TypeScript/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>TypeScript</span></a><a class="article-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>笔记</span></a><a class="article-meta__tags" href="/tags/%E7%BB%83%E4%B9%A0/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>练习</span></a></span></div></div><h1 class="post-title" itemprop="name headline">TypeScript笔记(二)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-10-30T12:10:10.000Z" title="发表于 2023-10-30 20:10:10">2023-10-30</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-07-05T10:06:49.602Z" title="更新于 2024-07-05 18:06:49">2024-07-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">11.7k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>50分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="TypeScript笔记(二)"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广州</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://mypic-ezp.pages.dev/img/img34.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://tom9527c.github.io/posts/7a0d2fdf.html"><header><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a><a href="/tags/%E5%89%8D%E7%AB%AF/" tabindex="-1" itemprop="url">前端</a><a href="/tags/TypeScript/" tabindex="-1" itemprop="url">TypeScript</a><a href="/tags/%E7%AC%94%E8%AE%B0/" tabindex="-1" itemprop="url">笔记</a><a href="/tags/%E7%BB%83%E4%B9%A0/" tabindex="-1" itemprop="url">练习</a><h1 id="CrawlerTitle" itemprop="name headline">TypeScript笔记(二)</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Tom</span><time itemprop="dateCreated datePublished" datetime="2023-10-30T12:10:10.000Z" title="发表于 2023-10-30 20:10:10">2023-10-30</time><time itemprop="dateCreated datePublished" datetime="2024-07-05T10:06:49.602Z" title="更新于 2024-07-05 18:06:49">2024-07-05</time></header><h1 id="1-泛型-generic"><a href="#1-泛型-generic" class="headerlink" title="1. 泛型 (generic)"></a>1. 泛型 (generic)</h1><h2 id="文档解释"><a href="#文档解释" class="headerlink" title="文档解释"></a>文档解释</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>软件工程中，我们不仅要创建一致的定义良好的API，同时也要考虑可重用性。 组件不仅能够支持当前的数据类型，同时也能支持未来的数据类型，这在创建大型系统时为你提供了十分灵活的功能。</p>
<p>在像C#和Java这样的语言中，可以使用<code>泛型</code>来创建可重用的组件，一个组件可以支持多种类型的数据。 这样用户就可以以自己的数据类型来使用组件。</p>
<h3 id="泛型之Hello-World"><a href="#泛型之Hello-World" class="headerlink" title="泛型之Hello World"></a>泛型之Hello World</h3><p>下面来创建第一个使用泛型的例子：identity函数。 这个函数会返回任何传入它的值。 你可以把这个函数当成是<code>echo</code>命令。</p>
<p>不用泛型的话，这个函数可能是下面这样：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">identity</span>(<span class="params">arg: <span class="built_in">number</span></span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者，我们使用<code>any</code>类型来定义函数：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">identity</span>(<span class="params">arg: <span class="built_in">any</span></span>): <span class="built_in">any</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<code>any</code>类型会导致这个函数可以接收任何类型的<code>arg</code>参数，这样就丢失了一些信息：传入的类型与返回的类型应该是相同的。 如果我们传入一个数字，我们只知道任何类型的值都有可能被返回。</p>
<p>因此，我们需要一种方法使返回值的类型与传入参数的类型是相同的。 这里，我们使用了<em>类型变量</em>，它是一种特殊的变量，只用于表示类型而不是值。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们给identity添加了类型变量<code>T</code>。 <code>T</code>帮助我们捕获用户传入的类型（比如：<code>number</code>），之后我们就可以使用这个类型。 之后我们再次使用了<code>T</code>当做返回值类型。现在我们可以知道参数类型与返回值类型是相同的了。 这允许我们跟踪函数里使用的类型的信息。</p>
<p>我们把这个版本的<code>identity</code>函数叫做泛型，因为它可以适用于多个类型。 不同于使用<code>any</code>，它不会丢失信息，像第一个例子那像保持准确性，传入数值类型并返回数值类型。</p>
<p>我们定义了泛型函数后，可以用两种方法使用。 第一种是，传入所有的参数，包含类型参数：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> output = identity&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;myString&quot;</span>);  <span class="comment">// type of output will be &#x27;string&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这里我们明确的指定了<code>T</code>是<code>string</code>类型，并做为一个参数传给函数，使用了<code>&lt;&gt;</code>括起来而不是<code>()</code>。</p>
<p>第二种方法更普遍。利用了<em>类型推论</em> – 即编译器会根据传入的参数自动地帮助我们确定T的类型：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> output = <span class="title function_">identity</span>(<span class="string">&quot;myString&quot;</span>);  <span class="comment">// type of output will be &#x27;string&#x27;</span></span><br></pre></td></tr></table></figure>
<p>注意我们没必要使用尖括号（<code>&lt;&gt;</code>）来明确地传入类型；编译器可以查看<code>myString</code>的值，然后把<code>T</code>设置为它的类型。 类型推论帮助我们保持代码精简和高可读性。如果编译器不能够自动地推断出类型的话，只能像上面那样明确的传入T的类型，在一些复杂的情况下，这是可能出现的。</p>
<h3 id="使用泛型变量"><a href="#使用泛型变量" class="headerlink" title="使用泛型变量"></a>使用泛型变量</h3><p>使用泛型创建像<code>identity</code>这样的泛型函数时，编译器要求你在函数体必须正确的使用这个通用的类型。 换句话说，你必须把这些参数当做是任意或所有类型。</p>
<p>看下之前<code>identity</code>例子：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们想同时打印出<code>arg</code>的长度。 我们很可能会这样做：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> loggingIdentity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arg.<span class="property">length</span>);  <span class="comment">// Error: T doesn&#x27;t have .length</span></span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果这么做，编译器会报错说我们使用了<code>arg</code>的<code>.length</code>属性，但是没有地方指明<code>arg</code>具有这个属性。 记住，这些类型变量代表的是任意类型，所以使用这个函数的人可能传入的是个数字，而数字是没有<code>.length</code>属性的。</p>
<p>现在假设我们想操作<code>T</code>类型的数组而不直接是<code>T</code>。由于我们操作的是数组，所以<code>.length</code>属性是应该存在的。 我们可以像创建其它数组一样创建这个数组：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> loggingIdentity&lt;T&gt;(<span class="attr">arg</span>: T[]): T[] &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arg.<span class="property">length</span>);  <span class="comment">// Array has a .length, so no more error</span></span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>你可以这样理解<code>loggingIdentity</code>的类型：泛型函数<code>loggingIdentity</code>，接收类型参数<code>T</code>和参数<code>arg</code>，它是个元素类型是<code>T</code>的数组，并返回元素类型是<code>T</code>的数组。 如果我们传入数字数组，将返回一个数字数组，因为此时<code>T</code>的的类型为<code>number</code>。 这可以让我们把泛型变量T当做类型的一部分使用，而不是整个类型，增加了灵活性。</p>
<p>我们也可以这样实现上面的例子：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> loggingIdentity&lt;T&gt;(<span class="attr">arg</span>: <span class="title class_">Array</span>&lt;T&gt;): <span class="title class_">Array</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arg.<span class="property">length</span>);  <span class="comment">// Array has a .length, so no more error</span></span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用过其它语言的话，你可能对这种语法已经很熟悉了。 在下一节，会介绍如何创建自定义泛型像<code>Array&lt;T&gt;</code>一样。</p>
<h3 id="泛型类型"><a href="#泛型类型" class="headerlink" title="泛型类型"></a>泛型类型</h3><p>上一节，我们创建了identity通用函数，可以适用于不同的类型。 在这节，我们研究一下函数本身的类型，以及如何创建泛型接口。</p>
<p>泛型函数的类型与非泛型函数的类型没什么不同，只是有一个类型参数在最前面，像函数声明一样：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">myIdentity</span>: &lt;T&gt;<span class="function">(<span class="params">arg: T</span>) =&gt;</span> T = identity;</span><br></pre></td></tr></table></figure>
<p>我们也可以使用不同的泛型参数名，只要在数量上和使用方式上能对应上就可以。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">myIdentity</span>: &lt;U&gt;<span class="function">(<span class="params">arg: U</span>) =&gt;</span> U = identity;</span><br></pre></td></tr></table></figure>
<p>我们还可以使用带有调用签名的对象字面量来定义泛型函数：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">myIdentity</span>: &#123;&lt;T&gt;(<span class="attr">arg</span>: T): T&#125; = identity;</span><br></pre></td></tr></table></figure>
<p>这引导我们去写第一个泛型接口了。 我们把上面例子里的对象字面量拿出来做为一个接口：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">GenericIdentityFn</span> &#123;</span><br><span class="line">    &lt;T&gt;(<span class="attr">arg</span>: T): T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">myIdentity</span>: <span class="title class_">GenericIdentityFn</span> = identity;</span><br></pre></td></tr></table></figure>
<p>一个相似的例子，我们可能想把泛型参数当作整个接口的一个参数。 这样我们就能清楚的知道使用的具体是哪个泛型类型（比如：<code>Dictionary&lt;string&gt;而不只是Dictionary</code>）。 这样接口里的其它成员也能知道这个参数的类型了。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">GenericIdentityFn</span>&lt;T&gt; &#123;</span><br><span class="line">    (<span class="attr">arg</span>: T): T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> identity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">myIdentity</span>: <span class="title class_">GenericIdentityFn</span>&lt;<span class="built_in">number</span>&gt; = identity;</span><br></pre></td></tr></table></figure>
<p>注意，我们的示例做了少许改动。 不再描述泛型函数，而是把非泛型函数签名作为泛型类型一部分。 当我们使用<code>GenericIdentityFn</code>的时候，还得传入一个类型参数来指定泛型类型（这里是：<code>number</code>），锁定了之后代码里使用的类型。 对于描述哪部分类型属于泛型部分来说，理解何时把参数放在调用签名里和何时放在接口上是很有帮助的。</p>
<p>除了泛型接口，我们还可以创建泛型类。 注意，无法创建泛型枚举和泛型命名空间。</p>
<h3 id="泛型类"><a href="#泛型类" class="headerlink" title="泛型类"></a>泛型类</h3><p>泛型类看上去与泛型接口差不多。 泛型类使用（<code>&lt;&gt;</code>）括起泛型类型，跟在类名后面。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GenericNumber</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="attr">zeroValue</span>: T;</span><br><span class="line">    <span class="attr">add</span>: <span class="function">(<span class="params">x: T, y: T</span>) =&gt;</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myGenericNumber = <span class="keyword">new</span> <span class="title class_">GenericNumber</span>&lt;<span class="built_in">number</span>&gt;();</span><br><span class="line">myGenericNumber.<span class="property">zeroValue</span> = <span class="number">0</span>;</span><br><span class="line">myGenericNumber.<span class="property">add</span> = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123; <span class="keyword">return</span> x + y; &#125;;</span><br></pre></td></tr></table></figure>
<p><code>GenericNumber</code>类的使用是十分直观的，并且你可能已经注意到了，没有什么去限制它只能使用<code>number</code>类型。 也可以使用字符串或其它更复杂的类型。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringNumeric = <span class="keyword">new</span> <span class="title class_">GenericNumber</span>&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">stringNumeric.<span class="property">zeroValue</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">stringNumeric.<span class="property">add</span> = <span class="keyword">function</span>(<span class="params">x, y</span>) &#123; <span class="keyword">return</span> x + y; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(stringNumeric.<span class="title function_">add</span>(stringNumeric.<span class="property">zeroValue</span>, <span class="string">&quot;test&quot;</span>));</span><br></pre></td></tr></table></figure>
<p>与接口一样，直接把泛型类型放在类后面，可以帮助我们确认类的所有属性都在使用相同的类型。</p>
<p>我们在<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.tsdev.cn/Classes.md">类</a>那节说过，类有两部分：静态部分和实例部分。 泛型类指的是实例部分的类型，所以类的静态属性不能使用这个泛型类型。</p>
<h3 id="泛型约束"><a href="#泛型约束" class="headerlink" title="泛型约束"></a>泛型约束</h3><p>你应该会记得之前的一个例子，我们有时候想操作某类型的一组值，并且我们知道这组值具有什么样的属性。 在<code>loggingIdentity</code>例子中，我们想访问<code>arg</code>的<code>length</code>属性，但是编译器并不能证明每种类型都有<code>length</code>属性，所以就报错了。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> loggingIdentity&lt;T&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arg.<span class="property">length</span>);  <span class="comment">// Error: T doesn&#x27;t have .length</span></span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>相比于操作any所有类型，我们想要限制函数去处理任意带有<code>.length</code>属性的所有类型。 只要传入的类型有这个属性，我们就允许，就是说至少包含这一属性。 为此，我们需要列出对于T的约束要求。</p>
<p>为此，我们定义一个接口来描述约束条件。 创建一个包含<code>.length</code>属性的接口，使用这个接口和<code>extends</code>关键字还实现约束：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Lengthwise</span> &#123;</span><br><span class="line">    <span class="attr">length</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> loggingIdentity&lt;T <span class="keyword">extends</span> <span class="title class_">Lengthwise</span>&gt;(<span class="attr">arg</span>: T): T &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arg.<span class="property">length</span>);  <span class="comment">// Now we know it has a .length property, so no more error</span></span><br><span class="line">    <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在这个泛型函数被定义了约束，因此它不再是适用于任意类型：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">loggingIdentity</span>(<span class="number">3</span>);  <span class="comment">// Error, number doesn&#x27;t have a .length property</span></span><br></pre></td></tr></table></figure>
<p>我们需要传入符合约束类型的值，必须包含必须的属性：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">loggingIdentity</span>(&#123;<span class="attr">length</span>: <span class="number">10</span>, <span class="attr">value</span>: <span class="number">3</span>&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="在泛型约束中使用类型参数"><a href="#在泛型约束中使用类型参数" class="headerlink" title="在泛型约束中使用类型参数"></a>在泛型约束中使用类型参数</h3><p>你可以声明一个类型参数，且它被另一个类型参数所约束。 比如，现在我们想要用属性名从对象里获取这个属性。 并且我们想要确保这个属性存在于对象<code>obj</code>上，因此我们需要在这两个类型之间使用约束。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getProperty&lt;T, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">obj</span>: T, <span class="attr">key</span>: K) &#123;</span><br><span class="line">    <span class="keyword">return</span> obj[key];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>, <span class="attr">d</span>: <span class="number">4</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getProperty</span>(x, <span class="string">&quot;a&quot;</span>); <span class="comment">// okay</span></span><br><span class="line"><span class="title function_">getProperty</span>(x, <span class="string">&quot;m&quot;</span>); <span class="comment">// error: Argument of type &#x27;m&#x27; isn&#x27;t assignable to &#x27;a&#x27; | &#x27;b&#x27; | &#x27;c&#x27; | &#x27;d&#x27;.</span></span><br></pre></td></tr></table></figure>
<h3 id="在泛型里使用类类型"><a href="#在泛型里使用类类型" class="headerlink" title="在泛型里使用类类型"></a>在泛型里使用类类型</h3><p>在TypeScript使用泛型创建工厂函数时，需要引用构造函数的类类型。比如，</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> create&lt;T&gt;(<span class="attr">c</span>: &#123;<span class="title function_">new</span>(): T; &#125;): T &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">c</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一个更高级的例子，使用原型属性推断并约束构造函数与类实例的关系。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BeeKeeper</span> &#123;</span><br><span class="line">    <span class="attr">hasMask</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ZooKeeper</span> &#123;</span><br><span class="line">    <span class="attr">nametag</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="attr">numLegs</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bee</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">    <span class="attr">keeper</span>: <span class="title class_">BeeKeeper</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Lion</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span> &#123;</span><br><span class="line">    <span class="attr">keeper</span>: <span class="title class_">ZooKeeper</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> createInstance&lt;A <span class="keyword">extends</span> <span class="title class_">Animal</span>&gt;(<span class="attr">c</span>: <span class="keyword">new</span> () =&gt; A): A &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">c</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createInstance</span>(<span class="title class_">Lion</span>).<span class="property">keeper</span>.<span class="property">nametag</span>;  <span class="comment">// typechecks!</span></span><br><span class="line"><span class="title function_">createInstance</span>(<span class="title class_">Bee</span>).<span class="property">keeper</span>.<span class="property">hasMask</span>;   <span class="comment">// typechecks!</span></span><br></pre></td></tr></table></figure>
<h2 id="学习解释"><a href="#学习解释" class="headerlink" title="学习解释"></a>学习解释</h2><h3 id="指定函数参数类型"><a href="#指定函数参数类型" class="headerlink" title="指定函数参数类型"></a>指定函数参数类型</h3><blockquote>
<p>泛型可以用于 函数、接口、类、type</p>
<p>如果在使用的时候 无法确定当时的类型，可以采用泛形来定义</p>
</blockquote>
<ul>
<li><p>单个泛型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getArray = &lt;T&gt;(<span class="attr">times</span>:<span class="built_in">number</span>,<span class="attr">val</span>:T):T[]=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">result</span>:T[] = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i&lt;times;i++)&#123;</span><br><span class="line">        result.<span class="title function_">push</span>(val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getArray</span>(<span class="number">3</span>,<span class="number">3</span>); <span class="comment">// 3 =&gt; T =&gt; number</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createArr = &lt;T&gt;(<span class="attr">times</span>: <span class="built_in">number</span>, <span class="attr">val</span>: T): T[] =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> arr = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; times; i++) &#123;</span><br><span class="line">        arr.<span class="title function_">push</span>(val)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">    <span class="comment">// return Array.from(&#123;length:times&#125;).fill(val)  as  T[]</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">createArr</span>(<span class="number">3</span>, <span class="string">&#x27;abc&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">createArr</span>(<span class="number">3</span>, <span class="number">123</span>))</span><br></pre></td></tr></table></figure>
</li>
<li><p>多个泛型</p>
<blockquote>
<p>写辅助函数的函数的时候可以写 多个泛型用于保存值</p>
<p>值的交换</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> swap&lt;T, K&gt;(<span class="attr">tuple</span>: [T, K]): [K, T] &#123;</span><br><span class="line">    <span class="keyword">return</span> [tuple[<span class="number">1</span>], tuple[<span class="number">0</span>]]</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">swap</span>([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> swap&lt;T,K&gt;(<span class="attr">tuple</span>:[T,K]):[K,T]&#123;</span><br><span class="line">    <span class="keyword">return</span> [tuple[<span class="number">1</span>],tuple[<span class="number">0</span>]]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> r = <span class="title function_">swap</span>([<span class="string">&#x27;jw&#x27;</span>,<span class="literal">true</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// IForEach&lt;T&gt; 表示使用接口的时候确定类型</span></span><br><span class="line"><span class="comment">// &lt;T&gt;():void 在使用这个函数的函数传入类型</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IForEach</span> &#123;</span><br><span class="line">    &lt;T&gt;(<span class="attr">arr</span>: T[],<span class="attr">callback</span>:<span class="function">(<span class="params">val:T</span>)=&gt;</span><span class="built_in">void</span>): <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// type ICallback = &lt;T&gt;(val: T) =&gt; void  //  错误写法 泛型的使用需要能正常推到，但是内部的callback没有真正的执行，还是认为arr:T[]</span></span><br><span class="line"> <span class="keyword">type</span> <span class="title class_">IForEach</span> = &lt;T&gt;<span class="function">(<span class="params">arr: T[], callback: ICallback</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">forEach</span>: <span class="title class_">IForEach</span> = <span class="function">(<span class="params">arr, callback</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">         <span class="comment">// ts 并没有真正的执行内部的callback(arr[i])</span></span><br><span class="line">        <span class="title function_">callback</span>(arr[i])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用forEach才传递的类型，而不是定义接口的时候 传递类型</span></span><br><span class="line"><span class="comment">// string | number | &#123;&#125;</span></span><br><span class="line"><span class="title function_">forEach</span>([<span class="string">&#x27;A&#x27;</span>, <span class="number">2</span>, <span class="number">3</span>,&#123;&#125;], <span class="keyword">function</span> (<span class="params">val</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(val)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="函数标注的方式"><a href="#函数标注的方式" class="headerlink" title="函数标注的方式"></a>函数标注的方式</h3><ul>
<li><p>类型别名</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">TArray</span> = &lt;T, K&gt;<span class="function">(<span class="params">tuple: [T, K]</span>) =&gt;</span> [K, T];</span><br><span class="line"><span class="keyword">const</span> <span class="attr">getArray</span>:<span class="title class_">TArray</span> = &lt;T, K&gt;(<span class="attr">tuple</span>: [T, K]): [K, T] =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> [tuple[<span class="number">1</span>], tuple[<span class="number">0</span>]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以使用类型别名，但是类型别名不能被继承和实现。一般联合类型可以使用类型别名来声明</p>
</blockquote>
</li>
<li><p>接口</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">IArray</span>&#123;</span><br><span class="line">    &lt;T,K&gt;(<span class="attr">typle</span>:[T,K]):[K,T]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">getArray</span>:<span class="title class_">IArray</span> = &lt;T, K&gt;(<span class="attr">tuple</span>: [T, K]): [K, T] =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> [tuple[<span class="number">1</span>], tuple[<span class="number">0</span>]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>能使用interface尽量使用interface</p>
</blockquote>
</li>
</ul>
<h3 id="泛型接口使用"><a href="#泛型接口使用" class="headerlink" title="泛型接口使用"></a>泛型接口使用</h3><blockquote>
<p>接口的返回值可能都是统一的  </p>
<p>code, data, message</p>
<p>泛型的默认值来解决泛型的值默认情况</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ISum</span>&lt;T&gt; &#123; <span class="comment">// 这里的T是使用接口的时候传入</span></span><br><span class="line">    &lt;U&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: T): U <span class="comment">// 这里的U是调用函数的时候传入</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">sum</span>: <span class="title class_">ISum</span>&lt;<span class="built_in">number</span>&gt; = <span class="function">(<span class="params">a:<span class="built_in">number</span>, b:<span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span> <span class="keyword">as</span> <span class="built_in">any</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">APIResponse</span>&lt;T = <span class="built_in">any</span>&gt; &#123;</span><br><span class="line">    <span class="attr">error</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">data</span>: T,</span><br><span class="line">    message?: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">LoginInfo</span> &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">token</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">login</span>(<span class="params"></span>): <span class="title class_">APIResponse</span> &#123; <span class="comment">// 请求方法</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">error</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="attr">username</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">            <span class="attr">token</span>: <span class="string">&#x27;xxxx&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;成功&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> r = <span class="title function_">login</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//  在平时开发中我门想使用联合类型 </span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IUnion</span>&lt;T = <span class="built_in">boolean</span>&gt; = T | <span class="built_in">string</span> | <span class="built_in">number</span></span><br><span class="line"><span class="keyword">type</span> t1 = <span class="title class_">IUnion</span></span><br><span class="line"><span class="keyword">type</span> t2 = <span class="title class_">IUnion</span>&lt;<span class="built_in">string</span>[] | <span class="built_in">number</span>[]&gt;</span><br></pre></td></tr></table></figure>
<h3 id="默认泛型"><a href="#默认泛型" class="headerlink" title="默认泛型"></a>默认泛型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> T2&lt;T=<span class="built_in">string</span>&gt;&#123;</span><br><span class="line">    <span class="attr">name</span>:T</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T22</span> = <span class="variable constant_">T2</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">name1</span>:<span class="variable constant_">T22</span> = &#123;<span class="attr">name</span>:<span class="string">&#x27;zf&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以指定泛型的默认类型，方便使用</p>
</blockquote>
<h3 id="类中的泛型"><a href="#类中的泛型" class="headerlink" title="类中的泛型"></a><strong>类中的泛型</strong></h3><ul>
<li><p>创建实例时提供类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyArray</span>&lt;T&gt;&#123; <span class="comment">// T =&gt; number</span></span><br><span class="line">    <span class="attr">arr</span>: T[] = [];</span><br><span class="line">    <span class="title function_">add</span>(<span class="params">num: T</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">arr</span>.<span class="title function_">push</span>(num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">getMaxNum</span>(): T &#123;</span><br><span class="line">        <span class="keyword">let</span> arr = <span class="variable language_">this</span>.<span class="property">arr</span></span><br><span class="line">        <span class="keyword">let</span> max = arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">let</span> current = arr[i];</span><br><span class="line">            current &gt; max ? max = current : <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> myArr = <span class="keyword">new</span> <span class="title class_">MyArray</span>&lt;<span class="built_in">number</span>&gt;();</span><br><span class="line">myArr.<span class="title function_">add</span>(<span class="number">3</span>);</span><br><span class="line">myArr.<span class="title function_">add</span>(<span class="number">1</span>);</span><br><span class="line">myArr.<span class="title function_">add</span>(<span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myArr.<span class="title function_">getMaxNum</span>());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyList</span>&lt;T <span class="keyword">extends</span> <span class="built_in">string</span> | <span class="built_in">number</span> = <span class="built_in">number</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="attr">arr</span>: T[] = []</span><br><span class="line">    <span class="title function_">add</span>(<span class="params">val: T</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">arr</span>.<span class="title function_">push</span>(val)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">getMax</span>(): T &#123;</span><br><span class="line">        <span class="keyword">let</span> max = <span class="variable language_">this</span>.<span class="property">arr</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">let</span> cur = <span class="variable language_">this</span>.<span class="property">arr</span>[i];</span><br><span class="line">            cur &gt; max ? (max = cur) : <span class="built_in">void</span> <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> list = <span class="keyword">new</span> <span class="title class_">MyList</span>&lt;<span class="built_in">string</span>&gt;</span><br><span class="line">list.<span class="title function_">add</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">list.<span class="title function_">add</span>(<span class="string">&#x27;100&#x27;</span>);</span><br><span class="line">list.<span class="title function_">add</span>(<span class="string">&#x27;200&#x27;</span>);</span><br><span class="line"></span><br><span class="line">list.<span class="title function_">getMax</span>(); <span class="comment">// 200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>校验构造函数类型</p>
<blockquote>
<p>ts只是对类型做校验，对于真正的业务逻辑不关心</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createClass = &lt;T&gt;(<span class="attr">clazz</span>: <span class="title function_">new</span>(<span class="attr">name</span>:<span class="built_in">string</span>,<span class="attr">age</span>:<span class="built_in">number</span>)=&gt;T):<span class="function"><span class="params">T</span> =&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">clazz</span>(name,age);</span><br><span class="line">&#125;</span><br><span class="line">createClass&lt;<span class="title class_">Person2</span>&gt;(<span class="title class_">Person2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> getObjVal&lt;T <span class="keyword">extends</span> <span class="built_in">object</span>, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">target</span>: T, <span class="attr">key</span>: K) &#123;</span><br><span class="line">    <span class="keyword">return</span> target[key]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person = &#123; <span class="attr">name</span>: <span class="string">&#x27;jw&#x27;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> animal = &#123; <span class="attr">name</span>: <span class="string">&#x27;tom&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">address</span>: <span class="string">&#x27;china&#x27;</span> &#125;;</span><br><span class="line"><span class="title function_">getObjVal</span>(animal, <span class="string">&quot;address&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="泛型约束-extends"><a href="#泛型约束-extends" class="headerlink" title="泛型约束 (extends)"></a>泛型约束 (extends)</h3><ul>
<li><p>泛型必须包含某些属性</p>
<blockquote>
<p>泛型是用户传递的类型（用户随便传？） 在使用泛型的时候 都要添加约束 泛型约束</p>
<p>我门在使用泛型的时候 不能直接做运算的 （无法保证泛型的结果 t + t = t?）</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">IWithLength</span> &#123;</span><br><span class="line">    <span class="attr">length</span>:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> getLen&lt;T <span class="keyword">extends</span> <span class="title class_">IWithLength</span>&gt;(<span class="attr">val</span>:T)&#123;</span><br><span class="line">    <span class="keyword">return</span> val.<span class="property">length</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getLen</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sum = &lt;T <span class="keyword">extends</span> <span class="built_in">number</span>&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: T): <span class="function"><span class="params">T</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (a + b) <span class="keyword">as</span> T</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> r = sum&lt;<span class="built_in">number</span>&gt;(<span class="number">1</span>, <span class="number">2</span>); </span><br></pre></td></tr></table></figure>
<p>约束当前这个类型T 需要是 string | number 子类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getLen&lt;T <span class="keyword">extends</span> &#123; <span class="attr">length</span>: <span class="built_in">number</span> &#125;&gt;(<span class="attr">val</span>: T) &#123;</span><br><span class="line">    <span class="keyword">return</span> val.<span class="property">length</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getLen</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line"><span class="title function_">getLen</span>(&#123; <span class="attr">length</span>: <span class="number">123</span> &#125;)</span><br><span class="line"><span class="comment">// getLen(123) 约束是某种类型的子类型</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>返回泛型中指定属性</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getVal = &lt;T,K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">obj</span>:T,<span class="attr">key</span>:K) : T[K]=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> obj[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="2-类型兼容性"><a href="#2-类型兼容性" class="headerlink" title="2.类型兼容性"></a>2.类型兼容性</h1><h2 id="文档解释-1"><a href="#文档解释-1" class="headerlink" title="文档解释"></a>文档解释</h2><h3 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h3><p>TypeScript里的类型兼容性是基于结构子类型的。 结构类型是一种只使用其成员来描述类型的方式。 它正好与名义（nominal）类型形成对比。（译者注：在基于名义类型的类型系统中，数据类型的兼容性或等价性是通过明确的声明和/或类型的名称来决定的。这与结构性类型系统不同，它是基于类型的组成结构，且不要求明确地声明。） 看下面的例子：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Named</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">p</span>: <span class="title class_">Named</span>;</span><br><span class="line"><span class="comment">// OK, because of structural typing</span></span><br><span class="line">p = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br></pre></td></tr></table></figure>
<p>在使用基于名义类型的语言，比如C#或Java中，这段代码会报错，因为Person类没有明确说明其实现了Named接口。</p>
<p>TypeScript的结构性子类型是根据JavaScript代码的典型写法来设计的。 因为JavaScript里广泛地使用匿名对象，例如函数表达式和对象字面量，所以使用结构类型系统来描述这些类型比使用名义类型系统更好。</p>
<h4 id="关于可靠性的注意事项"><a href="#关于可靠性的注意事项" class="headerlink" title="关于可靠性的注意事项"></a>关于可靠性的注意事项</h4><p>TypeScript的类型系统允许某些在编译阶段无法确认其安全性的操作。当一个类型系统具此属性时，被当做是“不可靠”的。TypeScript允许这种不可靠行为的发生是经过仔细考虑的。通过这篇文章，我们会解释什么时候会发生这种情况和其有利的一面。</p>
<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>TypeScript结构化类型系统的基本规则是，如果<code>x</code>要兼容<code>y</code>，那么<code>y</code>至少具有与<code>x</code>相同的属性。比如：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Named</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">x</span>: <span class="title class_">Named</span>;</span><br><span class="line"><span class="comment">// y&#x27;s inferred type is &#123; name: string; location: string; &#125;</span></span><br><span class="line"><span class="keyword">let</span> y = &#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">location</span>: <span class="string">&#x27;Seattle&#x27;</span> &#125;;</span><br><span class="line">x = y;</span><br></pre></td></tr></table></figure>
<p>这里要检查<code>y</code>是否能赋值给<code>x</code>，编译器检查<code>x</code>中的每个属性，看是否能在<code>y</code>中也找到对应属性。 在这个例子中，<code>y</code>必须包含名字是<code>name</code>的<code>string</code>类型成员。<code>y</code>满足条件，因此赋值正确。</p>
<p>检查函数参数时使用相同的规则：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">n: Named</span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Hello, &#x27;</span> + n.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">greet</span>(y); <span class="comment">// OK</span></span><br></pre></td></tr></table></figure>
<p>注意，<code>y</code>有个额外的<code>location</code>属性，但这不会引发错误。 只有目标类型（这里是<code>Named</code>）的成员会被一一检查是否兼容。</p>
<p>这个比较过程是递归进行的，检查每个成员及子成员。</p>
<h3 id="比较两个函数"><a href="#比较两个函数" class="headerlink" title="比较两个函数"></a>比较两个函数</h3><p>相对来讲，在比较原始类型和对象类型的时候是比较容易理解的，问题是如何判断两个函数是兼容的。 下面我们从两个简单的函数入手，它们仅是参数列表略有不同：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">x</span> = (<span class="params">a: <span class="built_in">number</span></span>) =&gt; <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">y</span> = (<span class="params">b: <span class="built_in">number</span>, s: <span class="built_in">string</span></span>) =&gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">y = x; <span class="comment">// OK</span></span><br><span class="line">x = y; <span class="comment">// Error</span></span><br></pre></td></tr></table></figure>
<p>要查看<code>x</code>是否能赋值给<code>y</code>，首先看它们的参数列表。 <code>x</code>的每个参数必须能在<code>y</code>里找到对应类型的参数。 注意的是参数的名字相同与否无所谓，只看它们的类型。 这里，<code>x</code>的每个参数在<code>y</code>中都能找到对应的参数，所以允许赋值。</p>
<p>第二个赋值错误，因为<code>y</code>有个必需的第二个参数，但是<code>x</code>并没有，所以不允许赋值。</p>
<p>你可能会疑惑为什么允许<code>忽略</code>参数，像例子<code>y = x</code>中那样。 原因是忽略额外的参数在JavaScript里是很常见的。 例如，<code>Array#forEach</code>给回调函数传3个参数：数组元素，索引和整个数组。 尽管如此，传入一个只使用第一个参数的回调函数也是很有用的：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> items = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Don&#x27;t force these extra arguments</span></span><br><span class="line">items.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(item));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Should be OK!</span></span><br><span class="line">items.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(item));</span><br></pre></td></tr></table></figure>
<p>下面来看看如何处理返回值类型，创建两个仅是返回值类型不同的函数：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">x</span> = (<span class="params"></span>) =&gt; (&#123;<span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">y</span> = (<span class="params"></span>) =&gt; (&#123;<span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">location</span>: <span class="string">&#x27;Seattle&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">x = y; <span class="comment">// OK</span></span><br><span class="line">y = x; <span class="comment">// Error because x() lacks a location property</span></span><br></pre></td></tr></table></figure>
<p>类型系统强制源函数的返回值类型必须是目标函数返回值类型的子类型。</p>
<h3 id="函数参数双向协变"><a href="#函数参数双向协变" class="headerlink" title="函数参数双向协变"></a>函数参数双向协变</h3><p>当比较函数参数类型时，只有当源函数参数能够赋值给目标函数或者反过来时才能赋值成功。 这是不稳定的，因为调用者可能传入了一个具有更精确类型信息的函数，但是调用这个传入的函数的时候却使用了不是那么精确的类型信息。 实际上，这极少会发生错误，并且能够实现很多JavaScript里的常见模式。例如：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">EventType</span> &#123; <span class="title class_">Mouse</span>, <span class="title class_">Keyboard</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Event</span> &#123; <span class="attr">timestamp</span>: <span class="built_in">number</span>; &#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MouseEvent</span> <span class="keyword">extends</span> <span class="title class_">Event</span> &#123; <span class="attr">x</span>: <span class="built_in">number</span>; <span class="attr">y</span>: <span class="built_in">number</span> &#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">KeyEvent</span> <span class="keyword">extends</span> <span class="title class_">Event</span> &#123; <span class="attr">keyCode</span>: <span class="built_in">number</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">listenEvent</span>(<span class="params">eventType: EventType, handler: (n: Event) =&gt; <span class="built_in">void</span></span>) &#123;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Unsound, but useful and common</span></span><br><span class="line"><span class="title function_">listenEvent</span>(<span class="title class_">EventType</span>.<span class="property">Mouse</span>, <span class="function">(<span class="params">e: MouseEvent</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">x</span> + <span class="string">&#x27;,&#x27;</span> + e.<span class="property">y</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Undesirable alternatives in presence of soundness</span></span><br><span class="line"><span class="title function_">listenEvent</span>(<span class="title class_">EventType</span>.<span class="property">Mouse</span>, <span class="function">(<span class="params">e: Event</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>((&lt;<span class="title class_">MouseEvent</span>&gt;e).<span class="property">x</span> + <span class="string">&#x27;,&#x27;</span> + (&lt;<span class="title class_">MouseEvent</span>&gt;e).<span class="property">y</span>));</span><br><span class="line"><span class="title function_">listenEvent</span>(<span class="title class_">EventType</span>.<span class="property">Mouse</span>, &lt;<span class="function">(<span class="params">e: Event</span>) =&gt;</span> <span class="built_in">void</span>&gt;(<span class="function">(<span class="params">e: MouseEvent</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">x</span> + <span class="string">&#x27;,&#x27;</span> + e.<span class="property">y</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Still disallowed (clear error). Type safety enforced for wholly incompatible types</span></span><br><span class="line"><span class="title function_">listenEvent</span>(<span class="title class_">EventType</span>.<span class="property">Mouse</span>, <span class="function">(<span class="params">e: <span class="built_in">number</span></span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(e));</span><br></pre></td></tr></table></figure>
<h3 id="可选参数及剩余参数"><a href="#可选参数及剩余参数" class="headerlink" title="可选参数及剩余参数"></a>可选参数及剩余参数</h3><p>比较函数兼容性的时候，可选参数与必须参数是可互换的。 源类型上有额外的可选参数不是错误，目标类型的可选参数在源类型里没有对应的参数也不是错误。</p>
<p>当一个函数有剩余参数时，它被当做无限个可选参数。</p>
<p>这对于类型系统来说是不稳定的，但从运行时的角度来看，可选参数一般来说是不强制的，因为对于大多数函数来说相当于传递了一些<code>undefinded</code>。</p>
<p>有一个好的例子，常见的函数接收一个回调函数并用对于程序员来说是可预知的参数但对类型系统来说是不确定的参数来调用：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">invokeLater</span>(<span class="params">args: <span class="built_in">any</span>[], callback: (...args: <span class="built_in">any</span>[]) =&gt; <span class="built_in">void</span></span>) &#123;</span><br><span class="line">    <span class="comment">/* ... Invoke callback with &#x27;args&#x27; ... */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Unsound - invokeLater &quot;might&quot; provide any number of arguments</span></span><br><span class="line"><span class="title function_">invokeLater</span>([<span class="number">1</span>, <span class="number">2</span>], <span class="function">(<span class="params">x, y</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(x + <span class="string">&#x27;, &#x27;</span> + y));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Confusing (x and y are actually required) and undiscoverable</span></span><br><span class="line"><span class="title function_">invokeLater</span>([<span class="number">1</span>, <span class="number">2</span>], <span class="function">(<span class="params">x?, y?</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(x + <span class="string">&#x27;, &#x27;</span> + y));</span><br></pre></td></tr></table></figure>
<h3 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h3><p>对于有重载的函数，源函数的每个重载都要在目标函数上找到对应的函数签名。 这确保了目标函数可以在所有源函数可调用的地方调用。</p>
<h3 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h3><p>枚举类型与数字类型兼容，并且数字类型与枚举类型兼容。不同枚举类型之间是不兼容的。比如，</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Status</span> &#123; <span class="title class_">Ready</span>, <span class="title class_">Waiting</span> &#125;;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Color</span> &#123; <span class="title class_">Red</span>, <span class="title class_">Blue</span>, <span class="title class_">Green</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> status = <span class="title class_">Status</span>.<span class="property">Ready</span>;</span><br><span class="line">status = <span class="title class_">Color</span>.<span class="property">Green</span>;  <span class="comment">//error</span></span><br></pre></td></tr></table></figure>
<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><p>类与对象字面量和接口差不多，但有一点不同：类有静态部分和实例部分的类型。 比较两个类类型的对象时，只有实例的成员会被比较。 静态成员和构造函数不在比较的范围内。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="attr">feet</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>, numFeet: <span class="built_in">number</span></span>) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Size</span> &#123;</span><br><span class="line">    <span class="attr">feet</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">numFeet: <span class="built_in">number</span></span>) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: <span class="title class_">Animal</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">s</span>: <span class="title class_">Size</span>;</span><br><span class="line"></span><br><span class="line">a = s;  <span class="comment">//OK</span></span><br><span class="line">s = a;  <span class="comment">//OK</span></span><br></pre></td></tr></table></figure>
<h3 id="类的私有成员"><a href="#类的私有成员" class="headerlink" title="类的私有成员"></a>类的私有成员</h3><p>私有成员会影响兼容性判断。 当类的实例用来检查兼容时，如果目标类型包含一个私有成员，那么源类型必须包含来自同一个类的这个私有成员。 这允许子类赋值给父类，但是不能赋值给其它有同样类型的类。</p>
<h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><p>因为TypeScript是结构性的类型系统，类型参数只影响使用其做为类型一部分的结果类型。比如，</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Empty</span>&lt;T&gt; &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">x</span>: <span class="title class_">Empty</span>&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">y</span>: <span class="title class_">Empty</span>&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line"></span><br><span class="line">x = y;  <span class="comment">// okay, y matches structure of x</span></span><br></pre></td></tr></table></figure>
<p>上面代码里，<code>x</code>和<code>y</code>是兼容的，因为它们的结构使用类型参数时并没有什么不同。 把这个例子改变一下，增加一个成员，就能看出是如何工作的了：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">NotEmpty</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="attr">data</span>: T;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">x</span>: <span class="title class_">NotEmpty</span>&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">y</span>: <span class="title class_">NotEmpty</span>&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line"></span><br><span class="line">x = y;  <span class="comment">// error, x and y are not compatible</span></span><br></pre></td></tr></table></figure>
<p>在这里，泛型类型在使用时就好比不是一个泛型类型。</p>
<p>对于没指定泛型类型的泛型参数时，会把所有泛型参数当成<code>any</code>比较。 然后用结果类型进行比较，就像上面第一个例子。</p>
<p>比如，</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> identity = <span class="keyword">function</span>&lt;T&gt;(<span class="attr">x</span>: T): T &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> reverse = <span class="keyword">function</span>&lt;U&gt;(<span class="attr">y</span>: U): U &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">identity = reverse;  <span class="comment">// Okay because (x: any)=&gt;any matches (y: any)=&gt;any</span></span><br></pre></td></tr></table></figure>
<h3 id="高级主题"><a href="#高级主题" class="headerlink" title="高级主题"></a>高级主题</h3><h4 id="子类型与赋值"><a href="#子类型与赋值" class="headerlink" title="子类型与赋值"></a>子类型与赋值</h4><p>目前为止，我们使用了<code>兼容性</code>，它在语言规范里没有定义。 在TypeScript里，有两种类型的兼容性：子类型与赋值。 它们的不同点在于，赋值扩展了子类型兼容，允许给<code>any</code>赋值或从<code>any</code>取值和允许数字赋值给枚举类型或枚举类型赋值给数字。</p>
<p>语言里的不同地方分别使用了它们之中的机制。 实际上，类型兼容性是由赋值兼容性来控制的，即使在<code>implements</code>和<code>extends</code>语句也不例外。 更多信息，请参阅<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">TypeScript语言规范</a>.</p>
<h2 id="学习解释-1"><a href="#学习解释-1" class="headerlink" title="学习解释"></a>学习解释</h2><h3 id="基本数据类型的兼容性"><a href="#基本数据类型的兼容性" class="headerlink" title="基本数据类型的兼容性"></a>基本数据类型的兼容性</h3><blockquote>
<p>ts兼容性分成两种 子 extends 父  结构来考虑</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">str</span>: <span class="built_in">string</span> = <span class="string">&quot;abc&quot;</span>; <span class="comment">// 类型层级</span></span><br><span class="line"><span class="keyword">let</span> obj!: &#123; <span class="title function_">toString</span>(): <span class="built_in">string</span> &#125;;</span><br><span class="line"></span><br><span class="line">obj = str; <span class="comment">// 结构来考虑   extends object   extends &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 安全性 ts 主要考虑的就是安全， 安全就可以进行复制</span></span><br><span class="line"><span class="comment">// obj.toString</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">temp</span>:<span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">let</span> num!:<span class="built_in">number</span>;</span><br><span class="line">temp = num;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>你要的我有就可以</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">num</span>:&#123;</span><br><span class="line">    <span class="title function_">toString</span>():<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">str</span>:<span class="built_in">string</span> = <span class="string">&#x27;zf&#x27;</span>;</span><br><span class="line">num = str; <span class="comment">// 字符串中具备toString()方法，所以可以进行兼容</span></span><br></pre></td></tr></table></figure>
<h3 id="接口兼容性"><a href="#接口兼容性" class="headerlink" title="接口兼容性"></a>接口兼容性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">IAnimal</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IPerson</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">animal</span>: <span class="title class_">IAnimal</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">person</span>: <span class="title class_">IPerson</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zf&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">11</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="string">&#x27;回龙观&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line">animal = person;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>接口的兼容性，只要满足接口中所需要的类型即可！</p>
</blockquote>
<h3 id="函数的兼容性"><a href="#函数的兼容性" class="headerlink" title="函数的兼容性"></a>函数的兼容性</h3><p>函数的兼容性主要是比较参数和返回值</p>
<ul>
<li><p>参数</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">sum1</span> = (<span class="params">a: <span class="built_in">string</span>, b: <span class="built_in">string</span></span>) =&gt; a + b;</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">sum2</span> = (<span class="params">a: <span class="built_in">string</span></span>) =&gt; a;</span><br><span class="line">sum1 = sum2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>赋值函数的参数要少于等于被赋值的函数，与对象相反,例如:</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Func</span>&lt;T&gt; = <span class="function">(<span class="params">item: T, index: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"><span class="keyword">function</span> forEach&lt;T&gt;(<span class="attr">arr</span>: T[], <span class="attr">cb</span>: <span class="title class_">Func</span>&lt;T&gt;) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="title function_">cb</span>(arr[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">forEach</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回值</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> sum1 = <span class="function">() =&gt;</span> <span class="built_in">string</span> | <span class="built_in">number</span></span><br><span class="line"><span class="keyword">type</span> sum2 = <span class="function">() =&gt;</span> <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">fn1</span>: sum1;</span><br><span class="line"><span class="keyword">let</span> fn2!: sum2;</span><br><span class="line">fn1 = fn2;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>参数和返回值的兼容性</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sum1 = (<span class="attr">a</span>: <span class="built_in">number</span>, <span class="attr">b</span>: <span class="built_in">number</span>): <span class="built_in">string</span> | <span class="function"><span class="params">number</span> =&gt;</span> a + b;</span><br><span class="line"><span class="keyword">let</span> sum2 = (<span class="attr">a</span>: <span class="built_in">number</span>): <span class="function"><span class="params">number</span> =&gt;</span> a;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Sum1</span> = <span class="keyword">typeof</span> sum1;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Sum2</span> = <span class="keyword">typeof</span> sum2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> X = <span class="title class_">Sum2</span> <span class="keyword">extends</span> <span class="title class_">Sum1</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对于函数而言他的兼容性， 少的可以赋予给多的， 参数少的是子类型</span></span><br><span class="line"><span class="comment">// 返回值要求安全, 返回值要求是子类型.</span></span><br><span class="line"><span class="keyword">const</span> forEach = &lt;T&gt;<span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  arr: T[],</span></span></span><br><span class="line"><span class="params"><span class="function">  callback: (val: T, key: <span class="built_in">number</span>) =&gt; <span class="built_in">string</span> | <span class="built_in">number</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> r = <span class="title function_">callback</span>(arr[i], i); <span class="comment">// 调用函数的时候 会传递多个参数</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">forEach</span>([<span class="string">&quot;A&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, &#123;&#125;], <span class="keyword">function</span> (<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id=""><a href="#" class="headerlink" title=" "></a> </h3></li>
</ul>
<h3 id="类的兼容性"><a href="#类的兼容性" class="headerlink" title="类的兼容性"></a>类的兼容性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Perent</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&#x27;zf&#x27;</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span> = <span class="number">11</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Parent1</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&#x27;zf&#x27;</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span> = <span class="number">11</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">parent</span>: <span class="title class_">Perent</span> = <span class="keyword">new</span> <span class="title class_">Parent1</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里要注意的是，只要有private或者protected关键字类型就会不一致;但是继承的类可以兼容</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent1</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&#x27;zf&#x27;</span>;</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span> = <span class="number">11</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent1</span>&#123;&#125; </span><br><span class="line"><span class="keyword">let</span> <span class="attr">child</span>:<span class="title class_">Parent1</span> = <span class="keyword">new</span> <span class="title class_">Child</span>;</span><br></pre></td></tr></table></figure>
<p>类的兼容性 也是一样  比较的是实例</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">b</span>: B = <span class="keyword">new</span> <span class="title function_">A</span>(); <span class="comment">// 如果类中的属性 有private 或者protected则两个值不能互相复制</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ts 这种叫结构化类型，标称类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 希望给基本类型做区分，达到差异化的目的</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> withType&lt;T, K&gt; = T &amp; [K];</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">BTC</span> = withType&lt;<span class="built_in">number</span>, <span class="string">&quot;BTC&quot;</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">USDT</span> = withType&lt;<span class="built_in">number</span>, <span class="string">&quot;USDT&quot;</span>&gt;; <span class="comment">// 基于内置类型来做构建</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> c1 = <span class="number">100</span> <span class="keyword">as</span> <span class="variable constant_">BTC</span>;</span><br><span class="line"><span class="keyword">const</span> c2 = <span class="number">100</span> <span class="keyword">as</span> <span class="variable constant_">USDT</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">money</span>(<span class="params">val: BTC</span>) &#123;&#125;</span><br><span class="line"><span class="title function_">money</span>(c1)</span><br></pre></td></tr></table></figure>
<h3 id="泛型的兼容性"><a href="#泛型的兼容性" class="headerlink" title="泛型的兼容性"></a>泛型的兼容性</h3><p>泛型兼容性， 如果生成的结果一致 类型就就兼容</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> IT&lt;T&gt;&#123;&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">obj1</span>:<span class="variable constant_">IT</span>&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line"><span class="keyword">let</span> obj2!:<span class="variable constant_">IT</span>&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line">obj1 = obj2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">II</span>&lt;T&gt; = &#123; name?: T &#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">X1</span> = <span class="variable constant_">II</span>&lt;<span class="built_in">string</span>&gt; <span class="keyword">extends</span> <span class="variable constant_">II</span>&lt;<span class="built_in">string</span>&gt; ? <span class="literal">true</span> : <span class="literal">false</span>; <span class="comment">// 生成结构一致即可</span></span><br></pre></td></tr></table></figure>
<h3 id="枚举的兼容性"><a href="#枚举的兼容性" class="headerlink" title="枚举的兼容性"></a>枚举的兼容性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">USER1</span> &#123;</span><br><span class="line">    role = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">USER2</span> &#123;</span><br><span class="line">    role = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> user1!:<span class="title class_">USER1</span></span><br><span class="line"><span class="keyword">let</span> user2!:<span class="title class_">USER2</span></span><br><span class="line">user1 = user2 <span class="comment">// 错误语法</span></span><br><span class="line"><span class="comment">// -------------</span></span><br><span class="line"><span class="keyword">enum</span> <span class="variable constant_">E1</span> &#123;</span><br><span class="line">  a = <span class="number">1</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> <span class="variable constant_">E2</span> &#123;</span><br><span class="line">  a = <span class="number">1</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> e1!: <span class="variable constant_">E1</span>.<span class="property">a</span>;</span><br><span class="line"><span class="keyword">let</span> e2!: <span class="variable constant_">E2</span>.<span class="property">a</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// e2 = e1; //两个枚举之间 不能兼容</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>不同的枚举类型不兼容</p>
</blockquote>
<h3 id="对象的兼容性"><a href="#对象的兼容性" class="headerlink" title="对象的兼容性"></a>对象的兼容性</h3><p>对象的兼容性， 多的属性可以赋予给少的</p>
<h3 id="类型层级兼容性，"><a href="#类型层级兼容性，" class="headerlink" title="类型层级兼容性，"></a>类型层级兼容性，</h3><p>never -&gt; 字面量 -&gt; 基础类型 -&gt; 包装类型 -&gt; any / unknown</p>
<p>子  extends  父  满足 即可赋值</p>
<h3 id="函数的逆变与协变"><a href="#函数的逆变与协变" class="headerlink" title="函数的逆变与协变"></a>函数的逆变与协变</h3><p>函数的参数是逆变的，返回值是协变的 （在非严格模式下函数的参数是双向协变的）</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">    <span class="attr">address</span>: <span class="built_in">string</span> = <span class="string">&#x27;回龙观&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">    <span class="attr">money</span>: <span class="built_in">number</span> = <span class="number">100</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Grandsom</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Child</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> = <span class="string">&#x27;吉姆&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Callback</span> = <span class="function">(<span class="params">person: Child</span>) =&gt;</span> <span class="title class_">Child</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">execCallback</span>(<span class="params">cb: Callback</span>) &#123; &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="title function_">fn</span> = (<span class="params">person: Parent</span>) =&gt; <span class="keyword">new</span> <span class="title class_">Grandsom</span>;</span><br><span class="line"><span class="title function_">execCallback</span>(fn);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>通过这个案例可以说明，函数参数可以接收父类，返回值可以返回子类</p>
</blockquote>
<p>逆变（在函数参数可以标记儿子传父亲）和协变（可以标记父亲返回儿子）</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">car</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">house</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Grandson</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Child</span> &#123;</span><br><span class="line">  <span class="title function_">sleep</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>安全性考虑</p>
<p>内部调用函数的时候 可以传递 Child 和 Grandson. 但是在使用属性时 只能认为最多就是child</p>
<p>函数的返回值, 需要返回子类，因为内部代码在访问属性的时候要保证可以访问到</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">callback: (ctr: Child) =&gt; Child</span>) &#123;</span><br><span class="line">  <span class="comment">// 我交给回调的有房、有车</span></span><br><span class="line">  <span class="keyword">let</span> r = <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Child</span>());</span><br><span class="line">  r.<span class="property">house</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fn</span>((<span class="attr">child</span>: <span class="title class_">Parent</span>): <span class="function"><span class="params">Grandson</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Grandson</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Arg</span>&lt;T&gt; = <span class="function">(<span class="params">arg: T</span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Return</span>&lt;T&gt; = <span class="function">(<span class="params">arg: <span class="built_in">any</span></span>) =&gt;</span> T;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ArgReturn</span> = <span class="title class_">Arg</span>&lt;<span class="title class_">Parent</span>&gt; <span class="keyword">extends</span> <span class="title class_">Arg</span>&lt;<span class="title class_">Child</span>&gt; ? <span class="literal">true</span> : <span class="literal">false</span>; <span class="comment">// 基于函数参数的逆变</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReturnReturn</span> = <span class="title class_">Return</span>&lt;<span class="title class_">Grandson</span>&gt; <span class="keyword">extends</span> <span class="title class_">Return</span>&lt;<span class="title class_">Child</span>&gt; ? <span class="literal">true</span> : <span class="literal">false</span>; <span class="comment">// </span></span><br></pre></td></tr></table></figure>
<h4 id="逆变带来的问题"><a href="#逆变带来的问题" class="headerlink" title="逆变带来的问题"></a>逆变带来的问题</h4><p>(我们写业务的时候 还是要正常开启逆变）</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">MyArray</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="comment">//   concat: (...args: T[]) =&gt; T[];</span></span><br><span class="line">  <span class="title function_">concat</span>(...<span class="attr">args</span>: T[]): T[]; <span class="comment">// 这种写法不进行逆变检测，所有在描述对象中的方法时全部采用这种方式</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// parent: (...args: Parent[]) =&gt; Parent[];</span></span><br><span class="line"><span class="comment">// child:  (...args: Child[]) =&gt; Child[];</span></span><br><span class="line"><span class="comment">// 将child 赋予给parent   传父返儿子</span></span><br><span class="line"><span class="keyword">let</span> parentArr!: <span class="title class_">MyArray</span>&lt;<span class="title class_">Parent</span>&gt;;</span><br><span class="line"><span class="keyword">let</span> childArr!: <span class="title class_">MyArray</span>&lt;<span class="title class_">Child</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// chilldArr 能不能赋予给 parentArr</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// [&#123;car()&#123;&#125;&#125;] = [&#123;car()&#123;&#125;,house()&#123;&#125;&#125;]</span></span><br><span class="line"></span><br><span class="line">parentArr = childArr;</span><br><span class="line"><span class="comment">// childArr = parentArr;</span></span><br></pre></td></tr></table></figure>
<h1 id="3-类型保护"><a href="#3-类型保护" class="headerlink" title="3.类型保护"></a>3.类型保护</h1><p>通过判断识别所执行的代码块，自动识别变量属性和方法</p>
<blockquote>
<p>类型保护  基于js + ts （收窄）</p>
<p>ts很多情况下 需要使用联合类型, 默认情况下只能使用公共的方法，识别类型 （针对某个类型进行处理）</p>
<p>typeof(基础类型)  instanceof(类类型)  in(接口类型，可辨识类型)</p>
</blockquote>
<h2 id="typeof类型保护"><a href="#typeof类型保护" class="headerlink" title="typeof类型保护"></a><code>typeof</code>类型保护</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">double</span>(<span class="params">val: <span class="built_in">number</span> | <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> val === <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">        val</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        val</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">a: <span class="built_in">string</span> | <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> a === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">    a; <span class="comment">// string</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    a; <span class="comment">// number</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">  <span class="title function_">cry</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">  <span class="title function_">eat</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getInstance</span>(<span class="params">clazz: &#123; <span class="keyword">new</span> (...args: <span class="built_in">any</span>[]): Cat | Dog &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">clazz</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="instanceof类型保护"><a href="#instanceof类型保护" class="headerlink" title="instanceof类型保护"></a><code>instanceof</code>类型保护</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> &#123; &#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getInstance</span> = (<span class="params">clazz: &#123; <span class="keyword">new</span>(): Cat | Dog &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">clazz</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> r = <span class="title function_">getInstance</span>(<span class="title class_">Cat</span>);</span><br><span class="line"><span class="keyword">if</span>(r <span class="keyword">instanceof</span> <span class="title class_">Cat</span>)&#123;</span><br><span class="line">    r</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    r</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = <span class="title function_">getInstance</span>(<span class="title class_">Cat</span>);</span><br><span class="line"><span class="keyword">if</span> (instance <span class="keyword">instanceof</span> <span class="title class_">Cat</span>) &#123;</span><br><span class="line">  instance.<span class="property">cry</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  instance.<span class="property">eat</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="in类型保护"><a href="#in类型保护" class="headerlink" title="in类型保护"></a><code>in</code>类型保护</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">    <span class="attr">swiming</span>: <span class="built_in">string</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="attr">fly</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">leg</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getType</span>(<span class="params">animal: Fish | Bird</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;swiming&#x27;</span> <span class="keyword">in</span> animal) &#123;</span><br><span class="line">        animal <span class="comment">// Fish</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        animal <span class="comment">// Bird</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>is 语法 ts语法  主要在辅助的方法中用的比较多</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&quot;鸟&quot;</span>;</span><br><span class="line">  <span class="attr">fly</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&quot;鱼&quot;</span>;</span><br><span class="line">  <span class="attr">swim</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isBird</span>(<span class="params">val: Bird | Fish</span>): val is <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="comment">// ts的返回值类型</span></span><br><span class="line">  <span class="comment">// 函数的名字 和返回值是无关的</span></span><br><span class="line">  <span class="comment">// true是bird 还是false 是bird</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;fly&quot;</span> <span class="keyword">in</span> val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAimal</span>(<span class="params">val: Bird | Fish</span>) &#123;</span><br><span class="line">  <span class="comment">// 基于差异化来辨别</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isBird</span>(val)) &#123;</span><br><span class="line">    val;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    val;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="可辨识联合类型"><a href="#可辨识联合类型" class="headerlink" title="可辨识联合类型"></a>可辨识联合类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">WarningButton</span> &#123;</span><br><span class="line">    <span class="attr">class</span>: <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DangerButton</span> &#123;</span><br><span class="line">    <span class="attr">class</span>: <span class="string">&#x27;danger&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createButton</span>(<span class="params">button: WarningButton | DangerButton</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (button.<span class="property">class</span> == <span class="string">&#x27;warning&#x27;</span>) &#123;</span><br><span class="line">        button <span class="comment">// WarningButton</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        button <span class="comment">// DangerButton</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可辨识类型  通过in来实现</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">nterface <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&quot;鸟&quot;</span>;</span><br><span class="line">  <span class="attr">fly</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&quot;鱼&quot;</span>;</span><br><span class="line">  <span class="attr">swim</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAimal</span>(<span class="params">val: Bird | Fish</span>) &#123;</span><br><span class="line">  <span class="comment">// 基于差异化来辨别</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;fly&quot;</span> <span class="keyword">in</span> val) &#123;</span><br><span class="line">    val;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    val;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (val.<span class="property">kind</span> == <span class="string">&quot;鸟&quot;</span>) &#123;</span><br><span class="line">    val.<span class="property">fly</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    val.<span class="property">swim</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过各种判断来缩小范围  生命周期 []</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> ensureArray&lt;T&gt;(<span class="attr">input</span>: T | T[]) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> input;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> [input];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> r1 = <span class="title function_">ensureArray</span>(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> r2 = <span class="title function_">ensureArray</span>([<span class="string">&quot;abc&quot;</span>]);</span><br></pre></td></tr></table></figure>
<p>函数的嵌套不识别的问题  ? ! if 都有缩小范围的用途 (基于上下文类型的推导，会因为作用域的变化 而产生问题)</p>
<p> ! 一定存在的意思  ?取值</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addType</span>(<span class="params">val?: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="comment">// 断言就是自己说的算，出错了自己承担</span></span><br><span class="line">  val = val || <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"><span class="keyword">type</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">type</span> + (val <span class="keyword">as</span> <span class="built_in">number</span>).<span class="title function_">toFixed</span>(); <span class="comment">// ts 无法识别的时候 需要用断言</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">addType</span>(<span class="number">100</span>)(<span class="string">&quot;$&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="null保护"><a href="#null保护" class="headerlink" title="null保护"></a>null保护</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">addPrefix</span> = (<span class="params">num?: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">    num = num || <span class="number">1.1</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">prefix</span>(<span class="params">fix: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> fix + num?.<span class="title function_">toFixed</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">prefix</span>(<span class="string">&#x27;zf&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">addPrefix</span>());</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里要注意的是ts无法检测内部函数变量类型</p>
</blockquote>
<h3 id="自定义类型保护"><a href="#自定义类型保护" class="headerlink" title="自定义类型保护"></a>自定义类型保护</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">    <span class="attr">swiming</span>: <span class="built_in">string</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="attr">fly</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">leg</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isBird</span>(<span class="params">animal: Fish | Bird</span>):animal is <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;swiming&#x27;</span> <span class="keyword">in</span> animal</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAniaml</span> (<span class="attr">animal</span>:<span class="title class_">Fish</span> | <span class="title class_">Bird</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_">isBird</span>(animal))&#123;</span><br><span class="line">        animal</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        animal</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="完整性保护"><a href="#完整性保护" class="headerlink" title="完整性保护"></a>完整性保护</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ICircle</span> &#123;</span><br><span class="line">    <span class="attr">kind</span>: <span class="string">&#x27;circle&#x27;</span>,</span><br><span class="line">    <span class="attr">r</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IRant</span> &#123;</span><br><span class="line">    <span class="attr">kind</span>: <span class="string">&#x27;rant&#x27;</span>,</span><br><span class="line">    <span class="attr">width</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISquare</span> &#123;</span><br><span class="line">    <span class="attr">kind</span>: <span class="string">&#x27;square&#x27;</span>,</span><br><span class="line">    <span class="attr">width</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Area</span> = <span class="title class_">ICircle</span> | <span class="title class_">IRant</span> | <span class="title class_">ISquare</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isAssertion</span> = (<span class="params">obj: <span class="built_in">never</span></span>) =&gt; &#123; &#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getArea</span> = (<span class="params">obj: Area</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">switch</span> (obj.<span class="property">kind</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;circle&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">3.14</span> * obj.<span class="property">r</span> ** <span class="number">2</span></span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">isAssertion</span>(obj); <span class="comment">// 必须实现所有逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4-交叉类型"><a href="#4-交叉类型" class="headerlink" title="4.交叉类型"></a>4.交叉类型</h1><p>交叉类型(Intersection Types)是将多个类型合并为一个类型</p>
<blockquote>
<p>联合类型（并集） ｜  按位或  交叉类型 （交集） &amp; 按位与 </p>
</blockquote>
<h3 id="交叉类型-Intersection-Types"><a href="#交叉类型-Intersection-Types" class="headerlink" title="交叉类型 (Intersection Types)"></a>交叉类型 (Intersection Types)</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person1</span> &#123;</span><br><span class="line">    <span class="attr">handsome</span>: <span class="built_in">string</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person2</span> &#123;</span><br><span class="line">    <span class="attr">high</span>: <span class="built_in">string</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">P1P2</span> = <span class="title class_">Person1</span> &amp; <span class="title class_">Person2</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">p</span>: <span class="variable constant_">P1P2</span> = &#123; <span class="attr">handsome</span>: <span class="string">&#x27;帅&#x27;</span>, <span class="attr">high</span>: <span class="string">&#x27;高&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>举例：我们提供两拨人，一拨人都很帅、另一拨人很高。我们希望找到他们的交叉部分 =&gt; 又高又帅的人</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> mixin&lt;T, K&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: K): T &amp; K &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; ...a, ...b &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> x = <span class="title function_">mixin</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;zf&#x27;</span> &#125;, &#123; <span class="attr">age</span>: <span class="number">11</span> &#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">IPerson1</span> &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IPerson2</span> &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="built_in">number</span></span><br><span class="line">    <span class="attr">age</span>:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> person = <span class="title class_">IPerson1</span> &amp; <span class="title class_">IPerson2</span></span><br><span class="line"><span class="keyword">let</span> name!:<span class="built_in">never</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">person</span>:person = &#123;name,<span class="attr">age</span>:<span class="number">11</span>&#125;;  <span class="comment">// 两个属性之间 string &amp; number的值为never</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//--------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person1</span> &#123;</span><br><span class="line">    <span class="attr">handsome</span>:<span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">gender</span>:<span class="built_in">number</span></span><br><span class="line">    <span class="attr">meta</span>:&#123;</span><br><span class="line">        <span class="attr">n</span>:<span class="built_in">number</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person2</span> &#123;</span><br><span class="line">    <span class="attr">high</span>:<span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">gender</span>:<span class="built_in">string</span></span><br><span class="line">    <span class="attr">meta</span>:&#123;</span><br><span class="line">        <span class="attr">n</span>:<span class="built_in">string</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Person3</span> = <span class="title class_">Person1</span> &amp; <span class="title class_">Person2</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IGender</span> = <span class="title class_">Person3</span>[<span class="string">&#x27;meta&#x27;</span>][<span class="string">&#x27;n&#x27;</span>]; <span class="comment">// 如果两个类型不相同没有交集 &amp;集后的结果是never</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">person</span>:<span class="title class_">Person1</span> | <span class="title class_">Person2</span> = &#123;</span><br><span class="line">    <span class="attr">high</span>:<span class="string">&#x27;高&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 交叉类型 同时是两个类型的子类型， 最终的结果可以赋予给任何的一个类型</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">person</span>:<span class="title class_">Person1</span> &amp; <span class="title class_">Person2</span> = &#123;</span><br><span class="line">     <span class="attr">handsome</span>:<span class="string">&#x27;帅&#x27;</span>,</span><br><span class="line">     <span class="attr">high</span>:<span class="string">&#x27;高&#x27;</span>,</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">// 子类型可以赋予给 父类型 （子类型的结构要包含父类型的结构）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">person1</span>:<span class="title class_">Person1</span> =person</span><br><span class="line"><span class="keyword">let</span> <span class="attr">person2</span>:<span class="title class_">Person2</span> =person</span><br></pre></td></tr></table></figure>
<h3 id="快速扩展属性"><a href="#快速扩展属性" class="headerlink" title="快速扩展属性"></a>快速扩展属性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">name</span>:<span class="string">&#x27;jw&#x27;</span>,<span class="attr">age</span>:<span class="number">30</span>&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">person</span>:&#123;<span class="attr">name</span>:<span class="built_in">string</span>,<span class="attr">age</span>:<span class="built_in">number</span>,<span class="attr">address</span>:<span class="built_in">string</span>&#125; = obj <span class="keyword">as</span> <span class="keyword">typeof</span> obj &amp; &#123;<span class="attr">address</span>:<span class="built_in">string</span>&#125;</span><br><span class="line"><span class="keyword">function</span> merge&lt;T <span class="keyword">extends</span> <span class="built_in">object</span> , K <span class="keyword">extends</span> <span class="built_in">object</span>&gt;(<span class="attr">o1</span>:T,<span class="attr">o2</span>:K)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;...o1,...o2&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result = <span class="title function_">merge</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;abc&#x27;</span>&#125;,&#123;<span class="attr">name</span>:<span class="number">123</span>&#125;)</span><br><span class="line"><span class="comment">// result.name</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>交叉类型和联合类型的区别， 平时我门使用的交叉类型场景还是很多的</p>
</blockquote>
<h1 id="5-条件类型"><a href="#5-条件类型" class="headerlink" title="5.条件类型"></a>5.条件类型</h1><blockquote>
<p>条件类型  if / else 三元表达式  (extends 左边 和 右边的关系)</p>
</blockquote>
<h3 id="条件类型基本使用"><a href="#条件类型基本使用" class="headerlink" title="条件类型基本使用"></a>条件类型基本使用</h3><p>可以使用<code>extends</code>关键字和三元表达式，实现条件判断</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">    <span class="attr">name1</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Water</span> &#123;</span><br><span class="line">    <span class="attr">name2</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="attr">name3</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Sky</span> &#123;</span><br><span class="line">    <span class="attr">name4</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Condition</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Fish</span> ? <span class="title class_">Water</span> : <span class="title class_">Sky</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">con1</span>: <span class="title class_">Condition</span>&lt;<span class="title class_">Fish</span>&gt; = &#123; <span class="attr">name2</span>: <span class="string">&#x27;水&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
<p>子类型 extends 父类型 = true</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">StatusCode</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="number">200</span> | <span class="number">201</span> | <span class="number">204</span> | <span class="number">304</span> ? <span class="string">&quot;success&quot;</span> : <span class="string">&quot;fail&quot;</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IReturnMessage</span> = <span class="title class_">StatusCode</span>&lt;<span class="number">200</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IObj</span>&lt;T&gt; = T <span class="keyword">extends</span> &#123; <span class="attr">name</span>: <span class="string">&quot;jw&quot;</span> &#125; ? <span class="string">&quot;ok&quot;</span> : <span class="string">&quot;no ok&quot;</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IPerson</span> = <span class="title class_">IObj</span>&lt;&#123; <span class="attr">name</span>: <span class="string">&quot;jw&quot;</span>; <span class="attr">age</span>: <span class="number">30</span> &#125;&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IPerson1</span> = <span class="title class_">IObj</span>&lt;&#123;&#125;&gt;;</span><br></pre></td></tr></table></figure>
<p>类型级别 1) 根据结构的角度来分析  2) 从类型角度来进行分析</p>
<blockquote>
<p>never 是任何类型的子类型</p>
<p>字面量类型</p>
<p> 基础类型</p>
<p>包装的类型</p>
<p> any unknown</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="variable constant_">T1</span> = <span class="built_in">never</span> <span class="keyword">extends</span> <span class="string">&quot;str&quot;</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T2</span> = <span class="string">&quot;str&quot;</span> <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T3</span> = <span class="built_in">string</span> <span class="keyword">extends</span> <span class="title class_">String</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>{} object Object  {} 和 object 可以看成字面量类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Temp1</span> = &#123;&#125; <span class="keyword">extends</span> <span class="built_in">object</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Temp2</span> = <span class="built_in">object</span> <span class="keyword">extends</span> &#123;&#125; ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Temp3</span> = <span class="built_in">object</span> <span class="keyword">extends</span> <span class="title class_">Object</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Temp4</span> = <span class="title class_">Object</span> <span class="keyword">extends</span> <span class="built_in">object</span> ? <span class="literal">true</span> : <span class="literal">false</span>; <span class="comment">// 因为从结构角度出发</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Temp5</span> = <span class="title class_">Object</span> <span class="keyword">extends</span> &#123;&#125; ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Temp6</span> = <span class="built_in">object</span> <span class="keyword">extends</span> &#123;&#125; ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>{}  object 可以看成结构， 和类型两部分</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="variable constant_">T4</span> = <span class="built_in">string</span> <span class="keyword">extends</span> <span class="built_in">object</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T5</span> = <span class="built_in">string</span> <span class="keyword">extends</span> <span class="built_in">any</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T6</span> = <span class="built_in">string</span> <span class="keyword">extends</span> <span class="built_in">unknown</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T7</span> = <span class="built_in">any</span> <span class="keyword">extends</span> <span class="built_in">unknown</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T8</span> = <span class="built_in">unknown</span> <span class="keyword">extends</span> <span class="built_in">any</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T9</span> = <span class="built_in">any</span> <span class="keyword">extends</span> <span class="number">1</span> ? <span class="literal">true</span> : <span class="literal">false</span>; <span class="comment">// (条件类型 是有分发机制) 1 + 除了1的部分  true ｜ false</span></span><br></pre></td></tr></table></figure>
<h3 id="条件类型分发"><a href="#条件类型分发" class="headerlink" title="条件类型分发"></a>条件类型分发</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">con2</span>: <span class="title class_">Condition</span>&lt;<span class="title class_">Fish</span>|<span class="title class_">Bird</span>&gt; = &#123; <span class="attr">name2</span>: <span class="string">&#x27;水&#x27;</span> &#125; </span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里会用每一项依次进行分发,最终采用联合类型作为结果,等价于:</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> c1 = <span class="title class_">Condition</span>&lt;<span class="title class_">Fish</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> c2 = <span class="title class_">Condition</span>&lt;<span class="title class_">Bird</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> c = c1 | c2</span><br></pre></td></tr></table></figure>
<h5 id="any自带分发的机制"><a href="#any自带分发的机制" class="headerlink" title="any自带分发的机制"></a>any自带分发的机制</h5><p>never 如果通过泛型传入，此时只会返回never</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="variable constant_">T10</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Temp7</span> = <span class="variable constant_">T10</span>&lt;<span class="built_in">never</span>&gt;;</span><br></pre></td></tr></table></figure>
<h5 id="联合类型的子类型-是联合类型中的某个类型"><a href="#联合类型的子类型-是联合类型中的某个类型" class="headerlink" title="联合类型的子类型 是联合类型中的某个类型"></a>联合类型的子类型 是联合类型中的某个类型</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="variable constant_">T11</span> = <span class="number">100</span> <span class="keyword">extends</span> <span class="number">100</span> | <span class="number">200</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<p>通过条件类型 来进行类型的区分，条件语句也可以实现约束的效果</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Fish</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;鱼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;鸟&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Water</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;水&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Sky</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;天&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="T-amp-就可以解决分发问题"><a href="#T-amp-就可以解决分发问题" class="headerlink" title="T &amp; {} 就可以解决分发问题"></a><code>T &amp; &#123;&#125;</code> 就可以解决分发问题</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">GetType</span>&lt;T <span class="keyword">extends</span> <span class="title class_">Fish</span> | <span class="title class_">Bird</span>&gt; = T &amp; &#123;&#125; <span class="keyword">extends</span> <span class="title class_">Fish</span> ? <span class="title class_">Water</span> : <span class="title class_">Sky</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>分发导致的问题： 什么时候会有分发</p>
<p>1.联合类型通过泛型传递</p>
<p>2.而且比较(extends)的时候会产生分发</p>
<p>3.类型需要是裸类型 (裸类型就是泛型 就自己没有和别人搭配)</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="variable constant_">A1</span> = <span class="title class_">GetType</span>&lt;<span class="title class_">Fish</span> | <span class="title class_">Bird</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">NoDistribute</span>&lt;T&gt; = T &amp; &#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>分发机制有的场景需要，有的场景需要禁用， 不能一概而论。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">UnionAssets</span>&lt;T, K&gt; = <span class="title class_">NoDistribute</span>&lt;T&gt; <span class="keyword">extends</span> K ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">U1</span> = <span class="title class_">UnionAssets</span>&lt;<span class="number">1</span> | <span class="number">2</span>, <span class="number">1</span> | <span class="number">2</span> | <span class="number">3</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">U2</span> = <span class="title class_">UnionAssets</span>&lt;<span class="number">1</span> | <span class="number">2</span> | <span class="number">3</span>, <span class="number">1</span> | <span class="number">2</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断两个类型是否完全一致 ？   1|2    1|2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> isEqual&lt;T, K, S, F&gt; = <span class="title class_">NoDistribute</span>&lt;T&gt; <span class="keyword">extends</span> K</span><br><span class="line">  ? <span class="title class_">NoDistribute</span>&lt;K&gt; <span class="keyword">extends</span> T</span><br><span class="line">    ? S</span><br><span class="line">    : F</span><br><span class="line">  : F;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">A2</span> = isEqual&lt;<span class="number">1</span> | <span class="number">2</span>, <span class="number">1</span> | <span class="number">2</span>, <span class="literal">true</span>, <span class="literal">false</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">FormatVal</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span></span><br><span class="line">  ? <span class="built_in">string</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="built_in">number</span></span><br><span class="line">  ? <span class="built_in">number</span></span><br><span class="line">  : <span class="built_in">never</span>;</span><br></pre></td></tr></table></figure>
<p>映射关系 可以考虑用泛型，参数个数不一致，类型和入参数无法，考虑重载</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> sum&lt;T <span class="keyword">extends</span> <span class="built_in">string</span> | <span class="built_in">number</span>&gt;(<span class="attr">a</span>: T, <span class="attr">b</span>: T): <span class="title class_">FormatVal</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> a + (b <span class="keyword">as</span> <span class="built_in">any</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> r = <span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<h1 id="6-内置类型"><a href="#6-内置类型" class="headerlink" title="6.内置类型"></a>6.内置类型</h1><h3 id="Exclude排除类型"><a href="#Exclude排除类型" class="headerlink" title="Exclude排除类型"></a><code>Exclude</code>排除类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Exclude</span>&lt;T, U&gt; = T <span class="keyword">extends</span> U ? <span class="built_in">never</span> : T;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyExclude</span> = <span class="title class_">Exclude</span>&lt;<span class="string">&#x27;1&#x27;</span> | <span class="string">&#x27;2&#x27;</span> | <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;1&#x27;</span> | <span class="string">&#x27;2&#x27;</span>&gt; <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<h3 id="Extract抽取类型"><a href="#Extract抽取类型" class="headerlink" title="Extract抽取类型"></a><code>Extract</code>抽取类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Extract</span>&lt;T, U&gt; = T <span class="keyword">extends</span> U ? T : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyExtract</span> = <span class="title class_">Extract</span>&lt;<span class="string">&#x27;1&#x27;</span> | <span class="string">&#x27;2&#x27;</span> | <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;1&#x27;</span> | <span class="string">&#x27;2&#x27;</span>&gt; <span class="comment">// 12</span></span><br></pre></td></tr></table></figure>
<h3 id="NoNullable-非空检测"><a href="#NoNullable-非空检测" class="headerlink" title="NoNullable 非空检测"></a><code>NoNullable</code> 非空检测</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">NonNullable</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="literal">null</span> | <span class="literal">undefined</span> ? <span class="built_in">never</span> : T</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyNone</span> = <span class="title class_">NonNullable</span>&lt;<span class="string">&#x27;a&#x27;</span> | <span class="literal">null</span> | <span class="literal">undefined</span>&gt; <span class="comment">// a</span></span><br></pre></td></tr></table></figure>
<h3 id="ReturnType返回值的类型"><a href="#ReturnType返回值的类型" class="headerlink" title="ReturnType返回值的类型"></a><code>ReturnType</code>返回值的类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">name</span>: <span class="string">&#x27;zf&#x27;</span>, <span class="attr">age</span>: <span class="number">10</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReturnType</span>&lt;T&gt; = T <span class="keyword">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>) =&gt; infer R ? R : <span class="built_in">never</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyReturn</span> = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> getUser&gt; <span class="comment">// type MyReturn = &#123;name: string;age: number;&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Parameters-返回参数的类型"><a href="#Parameters-返回参数的类型" class="headerlink" title="Parameters 返回参数的类型"></a><code>Parameters</code> 返回参数的类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Parameters</span>&lt;T&gt; = T <span class="keyword">extends</span> (...<span class="attr">args</span>: infer R) =&gt; <span class="built_in">any</span> ? R : <span class="built_in">any</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyParams</span> = <span class="title class_">Parameters</span>&lt;<span class="keyword">typeof</span> getUser&gt;; <span class="comment">// type MyParams = [a: number, b: number]</span></span><br></pre></td></tr></table></figure>
<h3 id="ConstructorParameters返回构造函数的参数类型"><a href="#ConstructorParameters返回构造函数的参数类型" class="headerlink" title="ConstructorParameters返回构造函数的参数类型"></a><code>ConstructorParameters</code>返回构造函数的参数类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>) &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ConstructorParameters</span>&lt;T&gt; = T <span class="keyword">extends</span> &#123; <span class="title function_">new</span>(...<span class="attr">args</span>: infer R): <span class="built_in">any</span> &#125; ? R : <span class="built_in">never</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyConstructor</span> = <span class="title class_">ConstructorParameters</span>&lt;<span class="keyword">typeof</span> <span class="title class_">Person</span>&gt; <span class="comment">// type MyConstructor = [name: string, age: number]</span></span><br></pre></td></tr></table></figure>
<h3 id="InstanceType-返回实例的类型"><a href="#InstanceType-返回实例的类型" class="headerlink" title="InstanceType 返回实例的类型"></a><code>InstanceType</code> 返回实例的类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">InstanceType</span>&lt;T&gt; = T <span class="keyword">extends</span> &#123; <span class="title function_">new</span>(...<span class="attr">args</span>: <span class="built_in">any</span>): infer R &#125; ? R : <span class="built_in">any</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MyInstance</span> = <span class="title class_">InstanceType</span>&lt;<span class="keyword">typeof</span> <span class="title class_">Person</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="infer实践"><a href="#infer实践" class="headerlink" title="infer实践"></a>infer实践</h3><p>将数组类型转化为联合类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ElementOf</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Array</span>&lt;infer E&gt; ? E : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TupleToUnion</span> = <span class="title class_">ElementOf</span>&lt;[<span class="built_in">string</span>, <span class="built_in">number</span>, <span class="built_in">boolean</span>]&gt;;</span><br></pre></td></tr></table></figure>
<p>将两个函数的参数转化为交叉类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="variable constant_">T1</span> = &#123; <span class="attr">name</span>: <span class="built_in">string</span> &#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="variable constant_">T2</span> = &#123; <span class="attr">age</span>: <span class="built_in">number</span> &#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ToIntersection</span>&lt;T&gt; = T <span class="keyword">extends</span> ([<span class="function">(<span class="params">x: infer U</span>) =&gt;</span> <span class="built_in">any</span>, <span class="function">(<span class="params">x: infer U</span>) =&gt;</span> <span class="built_in">any</span>]) ? U : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> t3 = <span class="title class_">ToIntersection</span>&lt;[<span class="function">(<span class="params">x:T1</span>)=&gt;</span><span class="built_in">any</span>,<span class="function">(<span class="params">x:T2</span>)=&gt;</span><span class="built_in">any</span>]&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>表示要把<code>T1</code>、<code>T2</code>赋予给x，那么x的值就是<code>T1</code>、<code>T2</code>的交集。（参数是逆变的可以传父类）</p>
<p>TS的类型：TS主要是为了代码的安全性来考虑。所以所有的兼容性问题都要从安全性来考虑!</p>
</blockquote>
<h3 id="Partial转化可选属性"><a href="#Partial转化可选属性" class="headerlink" title="Partial转化可选属性"></a>Partial转化可选属性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Company</span> &#123;</span><br><span class="line">    <span class="attr">num</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">company</span>: <span class="title class_">Company</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// type Partial&lt;T&gt; = &#123; [K in keyof T]?: T[K] &#125;; 实现原理</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialPerson</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">Person</span>&gt;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>遍历所有的属性将属性设置为可选属性,但是无法实现深度转化!</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">DeepPartial</span>&lt;T&gt; = &#123;</span><br><span class="line">    [K <span class="keyword">in</span> keyof T]?: T[K] <span class="keyword">extends</span> <span class="built_in">object</span> ? <span class="title class_">DeepPartial</span>&lt;T[K]&gt; : T[K]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepPartialPerson</span> = <span class="title class_">DeepPartial</span>&lt;<span class="title class_">Person</span>&gt;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>我们可以实现深度转化,如果值是对象继续深度转化。</p>
</blockquote>
<h3 id="Required转化必填属性"><a href="#Required转化必填属性" class="headerlink" title="Required转化必填属性"></a>Required转化必填属性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Company</span> &#123;</span><br><span class="line">    <span class="attr">num</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">company</span>: <span class="title class_">Company</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialPerson</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">Person</span>&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Required</span>&lt;T&gt; = &#123;[K <span class="keyword">in</span> keyof T]-?:T[K]&#125; </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">RequiredPerson</span> = <span class="title class_">Required</span>&lt;<span class="title class_">PartialPerson</span>&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将所有的属性转化成必填属性</p>
</blockquote>
<h3 id="Readonly转化仅读属性"><a href="#Readonly转化仅读属性" class="headerlink" title="Readonly转化仅读属性"></a>Readonly转化仅读属性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Readonly</span>&lt;T&gt; = &#123; <span class="keyword">readonly</span> [K <span class="keyword">in</span> keyof T]: T[K] &#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">RequiredPerson</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">Person</span>&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将所有属性变为仅读状态</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">IPerson</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">company</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Readonly</span>&lt;T&gt; = &#123;</span><br><span class="line">  +<span class="keyword">readonly</span> [K <span class="keyword">in</span> keyof T]: T[K];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ReadonlyRes</span> = <span class="title class_">Readonly</span>&lt;<span class="title class_">IPerson</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不能修改就是readonly ， 却掉readonly</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Mutate</span>&lt;T&gt; = &#123;</span><br><span class="line">  -<span class="keyword">readonly</span> [K <span class="keyword">in</span> keyof T]: T[K];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MutateRes</span> = <span class="title class_">Mutate</span>&lt;<span class="title class_">ReadonlyRes</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -? +?   -readonly +readonly</span></span><br></pre></td></tr></table></figure>
<h3 id="Pick挑选所需的属性"><a href="#Pick挑选所需的属性" class="headerlink" title="Pick挑选所需的属性"></a>Pick挑选所需的属性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Pick</span>&lt;T, U <span class="keyword">extends</span> keyof T&gt; = &#123; [P <span class="keyword">in</span> U]: T[P] &#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PickPerson</span> = <span class="title class_">Pick</span>&lt;<span class="title class_">Person</span>, <span class="string">&#x27;name&#x27;</span> | <span class="string">&#x27;age&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在已有类型中挑选所需属性</p>
</blockquote>
<h3 id="Omit忽略属性"><a href="#Omit忽略属性" class="headerlink" title="Omit忽略属性"></a>Omit忽略属性</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zhufeng&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">11</span>,</span><br><span class="line">    <span class="attr">address</span>: <span class="string">&#x27;回龙观&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Omit</span>&lt;T, K <span class="keyword">extends</span> keyof T&gt; = <span class="title class_">Pick</span>&lt;T, <span class="title class_">Exclude</span>&lt;keyof T, K&gt;&gt;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">OmitAddress</span> = <span class="title class_">Omit</span>&lt;<span class="keyword">typeof</span> person, <span class="string">&#x27;address&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>忽略person中的address属性 (先排除掉不需要的key，在通过key选出需要的属性)</p>
</blockquote>
<p>Omit Pick 对象来操作的</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">IPerson</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">company</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Pick</span>&lt;T, K <span class="keyword">extends</span> keyof T&gt; = &#123;</span><br><span class="line">  [key <span class="keyword">in</span> K]: T[key];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PickRes</span> = <span class="title class_">Pick</span>&lt;<span class="title class_">IPerson</span>, <span class="string">&quot;company&quot;</span> | <span class="string">&quot;age&quot;</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Omit</span>&lt;T, K <span class="keyword">extends</span> keyof <span class="built_in">any</span>&gt; = <span class="title class_">Pick</span>&lt;T, <span class="title class_">Exclude</span>&lt;keyof T, K&gt;&gt;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">OmitRes</span> = <span class="title class_">Omit</span>&lt;<span class="title class_">IPerson</span>, <span class="string">&quot;name&quot;</span> | <span class="string">&quot;age&quot;</span>&gt;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Pick和Omit用的比较多</p>
</blockquote>
<h3 id="Record记录类型"><a href="#Record记录类型" class="headerlink" title="Record记录类型"></a>Record记录类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Record</span>&lt;K <span class="keyword">extends</span> keyof <span class="built_in">any</span>, T&gt; = &#123; [P <span class="keyword">in</span> K]  : T &#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">person</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt; = &#123; <span class="attr">name</span>: <span class="string">&#x27;zf&#x27;</span>, <span class="attr">age</span>: <span class="number">11</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>实现map方法，我们经常用record类型表示映射类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> map&lt;T <span class="keyword">extends</span> keyof <span class="built_in">any</span>, K, U&gt;(<span class="attr">obj</span>: <span class="title class_">Record</span>&lt;T, K&gt;, <span class="attr">callback</span>: <span class="function">(<span class="params">item: K, key: T</span>) =&gt;</span> U) &#123;</span><br><span class="line">    <span class="keyword">let</span> result = &#123;&#125; <span class="keyword">as</span> <span class="title class_">Record</span>&lt;T, U&gt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        result[key] = <span class="title function_">callback</span>(obj[key], key)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> r = <span class="title function_">map</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;zf&#x27;</span>, <span class="attr">age</span>: <span class="number">11</span> &#125;, <span class="function">(<span class="params">item, key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> item</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>推导出类型  (根据泛型的位置 来推导具体的类型)</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> map&lt;T <span class="keyword">extends</span> keyof <span class="built_in">any</span>, K, R&gt;(</span><br><span class="line">  <span class="attr">obj</span>: <span class="title class_">Record</span>&lt;T, K&gt;,</span><br><span class="line">  <span class="attr">callback</span>: <span class="function">(<span class="params">value: K, key: T</span>) =&gt;</span> R</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">let</span> result = &#123;&#125; <span class="keyword">as</span> <span class="title class_">Record</span>&lt;T, R&gt;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    result[key] = <span class="title function_">callback</span>(obj[key], key);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">map</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;jw&quot;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;, <span class="function">(<span class="params">value, key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>infer  inference 手动类型推导</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getPerson</span>(<span class="params">a: <span class="built_in">string</span>, b: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">name</span>: <span class="string">&quot;jw&quot;</span>, <span class="attr">age</span>: <span class="number">30</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>类型推断 ， 因为infer 需要extends 关键字， 所以必须构建一个条件</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ReturnType</span>&lt;T <span class="keyword">extends</span> (...<span class="attr">args</span>: <span class="built_in">any</span>[]) =&gt; <span class="built_in">any</span>&gt; = T <span class="keyword">extends</span> (</span><br><span class="line">   ...<span class="attr">args</span>: <span class="built_in">any</span>[]</span><br><span class="line"> ) =&gt; infer R</span><br><span class="line">   ? R</span><br><span class="line">   : <span class="built_in">never</span>;</span><br></pre></td></tr></table></figure>
<p>infer 关键字需要基于extends</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">FnReturnType</span> = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> getPerson&gt;;</span><br><span class="line"><span class="comment">// type Parameters&lt;T extends (...args: any[]) =&gt; any&gt; = T extends (</span></span><br><span class="line"><span class="comment">//   ...args: infer P</span></span><br><span class="line"><span class="comment">// ) =&gt; any</span></span><br><span class="line"><span class="comment">//   ? P</span></span><br><span class="line"><span class="comment">//   : false;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">FnParamaters</span> = <span class="title class_">Parameters</span>&lt;<span class="keyword">typeof</span> getPerson&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">a: <span class="built_in">string</span>, b: <span class="built_in">string</span></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// type ConstructorParameters&lt;T extends &#123; new (...args: any[]): any &#125;&gt; =</span></span><br><span class="line"><span class="comment">//   T extends &#123; new (...args: infer P): any &#125; ? P : any;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ClassConstructorParameters</span> = <span class="title class_">ConstructorParameters</span>&lt;<span class="keyword">typeof</span> <span class="title class_">Person</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// type InstanceType&lt;T extends &#123; new (...args: any[]): any &#125;&gt; = T extends &#123;</span></span><br><span class="line"><span class="comment">//   new (...args: any[]): infer R;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">//   ? R</span></span><br><span class="line"><span class="comment">//   : any;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ClassInstanceType</span> = <span class="title class_">InstanceType</span>&lt;<span class="keyword">typeof</span> <span class="title class_">Person</span>&gt;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如何讲一个元组转化成联合和类型</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ITumple</span> = [<span class="built_in">string</span>, <span class="built_in">number</span>, <span class="built_in">boolean</span>]; <span class="comment">// string | number | boolean</span></span><br><span class="line"><span class="comment">// type TumpleToUniom = ITumple[number];</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ElementOf</span>&lt;T <span class="keyword">extends</span> <span class="built_in">any</span>[]&gt; = T <span class="keyword">extends</span> <span class="title class_">Array</span>&lt;infer R&gt; ? R : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">TumpleToUniom</span> = <span class="title class_">ElementOf</span>&lt;<span class="title class_">ITumple</span>&gt;;</span><br></pre></td></tr></table></figure>
<p>对元组进行参数移动， 将元组头尾进行交换 . infer 要配合 extends</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">SwapHeadTail</span>&lt;T <span class="keyword">extends</span> <span class="built_in">any</span>[]&gt; = T <span class="keyword">extends</span> [</span><br><span class="line">  infer <span class="title class_">Head</span>,</span><br><span class="line">  ...infer <span class="title class_">Body</span>,</span><br><span class="line">  infer <span class="title class_">Tail</span></span><br><span class="line">]</span><br><span class="line">  ? [<span class="title class_">Tail</span>, ...<span class="title class_">Body</span>, <span class="title class_">Head</span>]</span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Res</span> = <span class="title class_">SwapHeadTail</span>&lt;[<span class="string">&quot;jw&quot;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">30</span>]&gt;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>infer 可以递归推断</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// function getVal(): Promise&lt;Promise&lt;200&gt;&gt; &#123;</span></span><br><span class="line"><span class="comment">//   return new Promise((resolve, reject) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     resolve(</span></span><br><span class="line"><span class="comment">//       new Promise((resolve, reject) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//         resolve(200);</span></span><br><span class="line"><span class="comment">//       &#125;) as Promise&lt;200&gt;</span></span><br><span class="line"><span class="comment">//     );</span></span><br><span class="line"><span class="comment">//   &#125;);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PromiseVal</span>&lt;T&gt; = T <span class="keyword">extends</span> <span class="title class_">Promise</span>&lt;infer R&gt; ? <span class="title class_">PromiseVal</span>&lt;R&gt; : T;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PromiseReturnVal</span> = <span class="title class_">PromiseVal</span>&lt;<span class="title class_">Promise</span>&lt;<span class="title class_">Promise</span>&lt;<span class="number">200</span>&gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">   <span class="title function_">constructor</span>(<span class="params"><span class="keyword">public</span> name: <span class="built_in">string</span></span>) &#123;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">public</span> name: <span class="built_in">string</span></span>) &#123;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">function</span> createInstance&lt;T <span class="keyword">extends</span> &#123; <span class="keyword">new</span> (...<span class="attr">args</span>: <span class="built_in">any</span>[]): <span class="built_in">any</span> &#125;&gt;(</span><br><span class="line">  <span class="attr">clazz</span>: T,</span><br><span class="line">   <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line"> ): <span class="title class_">InstanceType</span>&lt;T&gt; &#123;</span><br><span class="line">   <span class="keyword">let</span> r = <span class="keyword">new</span> <span class="title function_">clazz</span>(name);</span><br><span class="line">   <span class="keyword">return</span> r;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">const</span> instance = <span class="title function_">createInstance</span>(<span class="title class_">Dog</span>, <span class="string">&quot;tom&quot;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="7-循环类型"><a href="#7-循环类型" class="headerlink" title="7.循环类型"></a>7.循环类型</h1><blockquote>
<p>Extract Exclude , NonNullable…</p>
<p>除了基于条件类型之外，我门还有基于对象类型</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Person1</span> &#123;</span><br><span class="line">  <span class="attr">handsome</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Person2</span> &#123;</span><br><span class="line">  <span class="attr">high</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for(let key in Object.keys(T) ) &#123; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IKeys1</span> = keyof <span class="built_in">any</span>; <span class="comment">// string | number | symbol  使用场景比较多</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IKeys2</span> = keyof <span class="built_in">unknown</span>; <span class="comment">//  never</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Compute</span>&lt;T <span class="keyword">extends</span> <span class="built_in">object</span>&gt; = &#123;</span><br><span class="line">  [xxxxxxxxx <span class="keyword">in</span> keyof T]: T[xxxxxxxxx];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Person3</span> = <span class="title class_">Compute</span>&lt;<span class="title class_">Person1</span> &amp; <span class="title class_">Person2</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// partial required pick omit.... 内置类型</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">IPerson</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ICompany</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">age</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">address</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">person</span>: <span class="title class_">IPerson</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Partial</span>&lt;T&gt; = &#123;</span><br><span class="line">  [key <span class="keyword">in</span> keyof T]?: T[key];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepPartial</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="comment">// 递归的深度可选</span></span><br><span class="line">  [key <span class="keyword">in</span> keyof T]?: T[key] <span class="keyword">extends</span> <span class="built_in">object</span> ? <span class="title class_">DeepPartial</span>&lt;T[key]&gt; : T[key];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialRes1</span> = <span class="title class_">DeepPartial</span>&lt;<span class="title class_">ICompany</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Required</span>&lt;T&gt; = &#123;</span><br><span class="line">  [key <span class="keyword">in</span> keyof T]-?: T[key];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DeepRequired</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="comment">// 递归的深度可选</span></span><br><span class="line">  [key <span class="keyword">in</span> keyof T]-?: T[key] &amp; &#123;&#125; <span class="keyword">extends</span> <span class="built_in">object</span></span><br><span class="line">    ? <span class="title class_">DeepRequired</span>&lt;T[key]&gt;</span><br><span class="line">    : T[key];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PartialRes2</span> = <span class="title class_">DeepRequired</span>&lt;<span class="title class_">PartialRes1</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">company</span>: <span class="title class_">PartialRes2</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">address</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">  <span class="attr">person</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;jw&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">30</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/02/avatar.webp" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/02/avatar.webp" title="头像" alt="头像"></a><div class="post-copyright__author_name">Tom</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://tom9527c.github.io/posts/7a0d2fdf.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://tom9527c.github.io/posts/7a0d2fdf.html')">TypeScript笔记(二)</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://tom9527c.github.io/posts/7a0d2fdf.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=TypeScript笔记(二)&amp;url=https://tom9527c.github.io/posts/7a0d2fdf.html&amp;pic=https://mypic-ezp.pages.dev/img/img34.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://tom9527c.github.io" target="_blank">Tom</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%89%8D%E7%AB%AF/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>前端<span class="tagsPageCount">25</span></a><a class="post-meta__box__tags" href="/tags/TypeScript/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>TypeScript<span class="tagsPageCount">4</span></a><a class="post-meta__box__tags" href="/tags/%E7%AC%94%E8%AE%B0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>笔记<span class="tagsPageCount">3</span></a><a class="post-meta__box__tags" href="/tags/%E7%BB%83%E4%B9%A0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>练习<span class="tagsPageCount">6</span></a></div></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/c8d1.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.guozy.online/img/2023/10/f60ceda3f75d7665ac303285a5a2bf8c.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">常见的Vue知识点</div></div></a></div><div class="next-post pull-right"><a href="/posts/4fe0ff4.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img35.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">TypeScript笔记(三)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/4fe0ff4.html" title="TypeScript笔记(三)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img35.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-31</div><div class="title">TypeScript笔记(三)</div></div></a></div><div><a href="/posts/9d362be7.html" title="TypeScript笔记（一）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img33.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-28</div><div class="title">TypeScript笔记（一）</div></div></a></div><div><a href="/posts/d044eab7.html" title="TypeScript"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img30.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-09-16</div><div class="title">TypeScript</div></div></a></div><div><a href="/posts/b5bf5235.html" title="el-input number类型右侧加减隐藏和中文光标偏移"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img39.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-20</div><div class="title">el-input number类型右侧加减隐藏和中文光标偏移</div></div></a></div><div><a href="/posts/bb44c5f1.html" title="el-input 限制输入框只能输入数字和小数"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img38.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-20</div><div class="title">el-input 限制输入框只能输入数字和小数</div></div></a></div><div><a href="/posts/2201da6a.html" title="Dialog设置遮罩穿透"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img37.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-20</div><div class="title">Dialog设置遮罩穿透</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author_top card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://tuchuang.voooe.cn/images/2023/01/02/avatar.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">Tom的日常</div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content"><div class="twopeople"><div class="container" style="height:200px;"><canvas class="illo" width="800" height="800" style="max-width:200px;max-height:200px;touch-action:none;width:640px;height:640px;"></canvas></div><script src="https://cdn.guozy.online/js/twopeople1.js"></script><script src="https://cdn.guozy.online/js/zdog.dist.js"></script><script id="rendered-js" src="https://cdn.guozy.online/js/twopeople.js"></script><style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center;}canvas{display:block;margin:0 auto;cursor:move;}</style></div></div><div id="welcome-info"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E6%B3%9B%E5%9E%8B-generic"><span class="toc-text">1. 泛型 (generic)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E6%A1%A3%E8%A7%A3%E9%87%8A"><span class="toc-text">文档解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E4%B9%8BHello-World"><span class="toc-text">泛型之Hello World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%9B%E5%9E%8B%E5%8F%98%E9%87%8F"><span class="toc-text">使用泛型变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%B1%BB%E5%9E%8B"><span class="toc-text">泛型类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%B1%BB"><span class="toc-text">泛型类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F"><span class="toc-text">泛型约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="toc-text">在泛型约束中使用类型参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%B3%9B%E5%9E%8B%E9%87%8C%E4%BD%BF%E7%94%A8%E7%B1%BB%E7%B1%BB%E5%9E%8B"><span class="toc-text">在泛型里使用类类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E8%A7%A3%E9%87%8A"><span class="toc-text">学习解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-text">指定函数参数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E6%A0%87%E6%B3%A8%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-text">函数标注的方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E6%8E%A5%E5%8F%A3%E4%BD%BF%E7%94%A8"><span class="toc-text">泛型接口使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E6%B3%9B%E5%9E%8B"><span class="toc-text">默认泛型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B"><span class="toc-text">类中的泛型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F-extends"><span class="toc-text">泛型约束 (extends)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E7%B1%BB%E5%9E%8B%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">2.类型兼容性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E6%A1%A3%E8%A7%A3%E9%87%8A-1"><span class="toc-text">文档解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D-1"><span class="toc-text">介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%8F%AF%E9%9D%A0%E6%80%A7%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">关于可靠性的注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B"><span class="toc-text">开始</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E4%B8%A4%E4%B8%AA%E5%87%BD%E6%95%B0"><span class="toc-text">比较两个函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E5%8F%8C%E5%90%91%E5%8D%8F%E5%8F%98"><span class="toc-text">函数参数双向协变</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0%E5%8F%8A%E5%89%A9%E4%BD%99%E5%8F%82%E6%95%B0"><span class="toc-text">可选参数及剩余参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD"><span class="toc-text">函数重载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="toc-text">枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB"><span class="toc-text">类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E7%A7%81%E6%9C%89%E6%88%90%E5%91%98"><span class="toc-text">类的私有成员</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B"><span class="toc-text">泛型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E4%B8%BB%E9%A2%98"><span class="toc-text">高级主题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E7%B1%BB%E5%9E%8B%E4%B8%8E%E8%B5%8B%E5%80%BC"><span class="toc-text">子类型与赋值</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E8%A7%A3%E9%87%8A-1"><span class="toc-text">学习解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">基本数据类型的兼容性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">接口兼容性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">函数的兼容性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text"> </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">类的兼容性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">泛型的兼容性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">枚举的兼容性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-text">对象的兼容性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%B1%82%E7%BA%A7%E5%85%BC%E5%AE%B9%E6%80%A7%EF%BC%8C"><span class="toc-text">类型层级兼容性，</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E9%80%86%E5%8F%98%E4%B8%8E%E5%8D%8F%E5%8F%98"><span class="toc-text">函数的逆变与协变</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%86%E5%8F%98%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">逆变带来的问题</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E7%B1%BB%E5%9E%8B%E4%BF%9D%E6%8A%A4"><span class="toc-text">3.类型保护</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#typeof%E7%B1%BB%E5%9E%8B%E4%BF%9D%E6%8A%A4"><span class="toc-text">typeof类型保护</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#instanceof%E7%B1%BB%E5%9E%8B%E4%BF%9D%E6%8A%A4"><span class="toc-text">instanceof类型保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#in%E7%B1%BB%E5%9E%8B%E4%BF%9D%E6%8A%A4"><span class="toc-text">in类型保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E8%BE%A8%E8%AF%86%E8%81%94%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="toc-text">可辨识联合类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null%E4%BF%9D%E6%8A%A4"><span class="toc-text">null保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E4%BF%9D%E6%8A%A4"><span class="toc-text">自定义类型保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E4%BF%9D%E6%8A%A4"><span class="toc-text">完整性保护</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E4%BA%A4%E5%8F%89%E7%B1%BB%E5%9E%8B"><span class="toc-text">4.交叉类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E5%8F%89%E7%B1%BB%E5%9E%8B-Intersection-Types"><span class="toc-text">交叉类型 (Intersection Types)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E6%89%A9%E5%B1%95%E5%B1%9E%E6%80%A7"><span class="toc-text">快速扩展属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="toc-text">5.条件类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">条件类型基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B%E5%88%86%E5%8F%91"><span class="toc-text">条件类型分发</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#any%E8%87%AA%E5%B8%A6%E5%88%86%E5%8F%91%E7%9A%84%E6%9C%BA%E5%88%B6"><span class="toc-text">any自带分发的机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%94%E5%90%88%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AD%90%E7%B1%BB%E5%9E%8B-%E6%98%AF%E8%81%94%E5%90%88%E7%B1%BB%E5%9E%8B%E4%B8%AD%E7%9A%84%E6%9F%90%E4%B8%AA%E7%B1%BB%E5%9E%8B"><span class="toc-text">联合类型的子类型 是联合类型中的某个类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#T-amp-%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%A7%A3%E5%86%B3%E5%88%86%E5%8F%91%E9%97%AE%E9%A2%98"><span class="toc-text">T &amp; {} 就可以解决分发问题</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">6.内置类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exclude%E6%8E%92%E9%99%A4%E7%B1%BB%E5%9E%8B"><span class="toc-text">Exclude排除类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Extract%E6%8A%BD%E5%8F%96%E7%B1%BB%E5%9E%8B"><span class="toc-text">Extract抽取类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NoNullable-%E9%9D%9E%E7%A9%BA%E6%A3%80%E6%B5%8B"><span class="toc-text">NoNullable 非空检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReturnType%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">ReturnType返回值的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Parameters-%E8%BF%94%E5%9B%9E%E5%8F%82%E6%95%B0%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">Parameters 返回参数的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ConstructorParameters%E8%BF%94%E5%9B%9E%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-text">ConstructorParameters返回构造函数的参数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InstanceType-%E8%BF%94%E5%9B%9E%E5%AE%9E%E4%BE%8B%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">InstanceType 返回实例的类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#infer%E5%AE%9E%E8%B7%B5"><span class="toc-text">infer实践</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Partial%E8%BD%AC%E5%8C%96%E5%8F%AF%E9%80%89%E5%B1%9E%E6%80%A7"><span class="toc-text">Partial转化可选属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Required%E8%BD%AC%E5%8C%96%E5%BF%85%E5%A1%AB%E5%B1%9E%E6%80%A7"><span class="toc-text">Required转化必填属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Readonly%E8%BD%AC%E5%8C%96%E4%BB%85%E8%AF%BB%E5%B1%9E%E6%80%A7"><span class="toc-text">Readonly转化仅读属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pick%E6%8C%91%E9%80%89%E6%89%80%E9%9C%80%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-text">Pick挑选所需的属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Omit%E5%BF%BD%E7%95%A5%E5%B1%9E%E6%80%A7"><span class="toc-text">Omit忽略属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Record%E8%AE%B0%E5%BD%95%E7%B1%BB%E5%9E%8B"><span class="toc-text">Record记录类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%BE%AA%E7%8E%AF%E7%B1%BB%E5%9E%8B"><span class="toc-text">7.循环类型</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/87e72661.html" title="uniapp-vue2 页面生成PDF"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img61.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="uniapp-vue2 页面生成PDF"/></a><div class="content"><a class="title" href="/posts/87e72661.html" title="uniapp-vue2 页面生成PDF">uniapp-vue2 页面生成PDF</a><time datetime="2024-07-10T06:20:59.000Z" title="发表于 2024-07-10 14:20:59">2024-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/bb44c5f1.html" title="el-input 限制输入框只能输入数字和小数"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img38.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="el-input 限制输入框只能输入数字和小数"/></a><div class="content"><a class="title" href="/posts/bb44c5f1.html" title="el-input 限制输入框只能输入数字和小数">el-input 限制输入框只能输入数字和小数</a><time datetime="2024-03-20T08:20:15.000Z" title="发表于 2024-03-20 16:20:15">2024-03-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b5bf5235.html" title="el-input number类型右侧加减隐藏和中文光标偏移"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img39.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="el-input number类型右侧加减隐藏和中文光标偏移"/></a><div class="content"><a class="title" href="/posts/b5bf5235.html" title="el-input number类型右侧加减隐藏和中文光标偏移">el-input number类型右侧加减隐藏和中文光标偏移</a><time datetime="2024-03-20T08:16:05.000Z" title="发表于 2024-03-20 16:16:05">2024-03-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2201da6a.html" title="Dialog设置遮罩穿透"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img37.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Dialog设置遮罩穿透"/></a><div class="content"><a class="title" href="/posts/2201da6a.html" title="Dialog设置遮罩穿透">Dialog设置遮罩穿透</a><time datetime="2024-03-20T07:49:33.000Z" title="发表于 2024-03-20 15:49:33">2024-03-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5f3c0533.html" title="常用命令"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://mypic-ezp.pages.dev/img/img36.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常用命令"/></a><div class="content"><a class="title" href="/posts/5f3c0533.html" title="常用命令">常用命令</a><time datetime="2024-02-25T14:11:38.000Z" title="发表于 2024-02-25 22:11:38">2024-02-25</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By Tom</div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.guozy.online/config/Aurora-%E4%B8%8A%E7%8F%AD%E6%91%B8%E9%B1%BC%E4%B8%AD.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">61</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">7</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" rel="external nofollow noreferrer" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://tom9527c.github.io/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="anzhiyufont anzhiyu-icon-book-open faa-tada" style="font-size: 0.9em;"></i><span> 藏宝阁</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button type="button" title="切换背景" onclick="toggleWinbox()"><i class="fas fa-display"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script>var meting_api = "https://meting.qjqq.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r";
</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("4/27/2023 22:18:52"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2023 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Tom 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("4/27/2023 22:18:52"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://cdn.guozy.online/config/Aurora-%E4%B8%8B%E7%8F%AD%E5%95%A6.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script async src="/custom/js/welcome.js"></script><script async src="/custom/js/vue.min.js"></script><script async src="/custom/js/elementUI.min.js"></script><script async src="/custom/js/imgStatus.min.js"></script><script async src="/custom/js/lately.min.js"></script><script async src="/custom/js/dailyPhoto.js" async></script><script async src="/custom/js/fps.js"></script><script async src="/custom/js/winBox/winbox.bundle.min.js"></script><script defer src="/custom/js/winBox/winbox.js"></script><script async src="/custom/js/aurora.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>